[
    {
        "mspp_attachfilerequirederrormessage":  null,
        "mspp_tabname":  null,
        "mspp_appendquerystring":  false,
        "mspp_forceallfieldsrequired":  false,
        "mspp_referencetargetlookupattributelogicalname":  null,
        "mspp_targetentitylogicalname":  "msdyn_appointmentrequest",
        "mspp_loguser":  false,
        "mspp_referencesourceentitylogicalname":  null,
        "mspp_nextbuttontext":  null,
        "mspp_renderwebresourcesinline":  false,
        "mspp_useridentitynameattributelogicalname":  null,
        "mspp_webformstepid":  "a4ca19a0-d4dc-f011-8406-002248e10de6",
        "_mspp_modifiedby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_autogeneratesteps":  false,
        "mspp_createdon":  "2025-12-19T12:17:11Z",
        "mspp_editexpiredstatecode":  null,
        "mspp_submiteventkeyname":  null,
        "mspp_redirecturlcustomquerystring":  null,
        "mspp_nextbuttoncssclass":  null,
        "mspp_accept":  null,
        "mspp_movepreviouseventkeyname":  null,
        "mspp_captcharequired":  false,
        "mspp_referenceentityreadonlyformname":  "",
        "mspp_formname":  "Create an Appointment Step 4",
        "mspp_validationsummaryheadertext":  null,
        "mspp_referenceentitysourcetype":  100000001,
        "mspp_referencerecordsourcerelationshipname":  null,
        "mspp_savingeventkeyname":  null,
        "mspp_condition":  null,
        "_mspp_referenceentitystep_value":  null,
        "mspp_autonumberattributelogicalname":  null,
        "mspp_settings":  null,
        "mspp_usercontrolpath":  null,
        "mspp_previousbuttontext":  null,
        "mspp_editexpiredstatusreason":  null,
        "mspp_hideformonsuccess":  true,
        "mspp_showunsupportedfields":  false,
        "mspp_attachfilerequired":  false,
        "mspp_entitypermissionsenabled":  true,
        "mspp_showownerfields":  false,
        "mspp_attachfilelabel":  null,
        "mspp_usercontroltitle":  "",
        "mspp_targetentityprimarykeylogicalname":  null,
        "mspp_attachfilestoragelocation":  null,
        "mspp_submitbuttontext":  null,
        "mspp_recordnotfoundmessage":  null,
        "mspp_redirecturlappendentityidquerystring":  false,
        "mspp_containername":  null,
        "statecode":  0,
        "mspp_redirecturlquerystringattributeparamname":  null,
        "mspp_geolocation_longitudefieldname":  null,
        "mspp_attachfile":  false,
        "mspp_geolocation_displaymap":  false,
        "mspp_setentityreference":  false,
        "mspp_referencequerystringname":  null,
        "mspp_geolocation_cityfieldname":  null,
        "mspp_editnotpermittedmessage":  null,
        "mspp_editexpiredmessage":  null,
        "mspp_showcaptchaforauthenticatedusers":  false,
        "mspp_loadeventkeyname":  null,
        "mspp_recommendedfieldsrequired":  false,
        "mspp_geolocation_countryfieldname":  null,
        "mspp_registerstartupscript":  "$(function() {\r\n    $(\u0027[data-name=\"hidden-section\"]\u0027).parent().hide();\r\n    sessionStorage.setItem(\"BankRep\", $(\"#msdyn_bankrepcontact\").val());\r\n\r\n    if($(\"#msdynce_selectedtimeslot\").val() == \u0027\u0027) sessionStorage.removeItem(\"selectedDateTime\");\r\n\r\n    calendarLoad(checkIfIframeLoaded);\r\n});\r\n\r\n\r\nfunction calendarLoad(callback){\r\n    var iframe = $(\u0027#WebResource_TimeSlotSelector\u0027);    \r\n    iframe.on(\u0027load\u0027, function() {        \r\n        callback(this);\r\n    });\r\n}\r\n\r\nfunction checkIfIframeLoaded(iframe) {\r\n    var iframeDoc = iframe.contentDocument || iframe.contentWindow.document;\r\n    var radioSlotObj = $(\"input[name=\u0027time\u0027]\", iframeDoc);\r\n\r\n    if(radioSlotObj != undefined){\r\n        radioSlotObj.click(function() {\r\n            var dateValueNext, timeValueNext;\r\n            var radioDateVal = $(\"input[name=\u0027weekview\u0027]:checked\", iframeDoc);\r\n            if(radioDateVal != undefined){\r\n                dateValueNext = radioDateVal.next(\"div.day-date\").find(\".slotDate\").text();\r\n                var radioSlotVal = $(\"input[name=\u0027time\u0027]:checked\", iframeDoc);\r\n                if(radioSlotVal != undefined){\r\n                    timeValueNext = radioSlotVal.next(\"div.time\").find(\"em\").text();\r\n                    var startDate = moment(dateValueNext + \" \" + timeValueNext).format(\u0027MM/DD/YYYY h:mm a\u0027);\r\n                    var endDate = moment(startDate).add(1, \u0027hours\u0027).format(\u0027MM/DD/YYYY h:mm a\u0027);\r\n                    setDateControlFieldValue(\"msdynce_scheduledstart\",startDate);\r\n                    setDateControlFieldValue(\"msdynce_scheduledend\", endDate); \r\n                    sessionStorage.setItem(\"selectedDateTime\",  moment(dateValueNext + \" \" + timeValueNext).format(\u0027MMM DD hh:mm a\u0027));\r\n                    $(\"#msdynce_selectedtimeslot\").val( moment(dateValueNext + \" \" + timeValueNext).format(\u0027MMM DD, YYYY | hh:mm A\u0027));\r\n                }\r\n            }\r\n        });  \r\n    }\r\n}\r\n\r\nfunction setDateControlFieldValue(fieldname,d){\r\n   //debugger;\r\n   var datefield = $(\u0027#\u0027+ fieldname);\r\n   var inputControl = $(\u0027#\u0027+ fieldname +\u0027_datepicker_description\u0027);\r\n   var dateFormat = inputControl.attr(\u0027data-date-format\u0027);\r\n   var dateVal = Date.parse(d);\r\n   var dateUTC = moment(dateVal).utc();\r\n\r\n   datefield.val(dateUTC.format(\u0027YYYY-MM-DDTHH:mm:ss.0000000\\\\Z\u0027));   \r\n   inputControl.val(dateUTC.format(dateFormat));\r\n}\r\n\r\nfunction setEmailRange(){}",
        "statuscode":  1,
        "mspp_attachfilerestrictaccept":  false,
        "mspp_validationsummarylinktext":  null,
        "_mspp_nextstep_value":  "e75b17a6-d4dc-f011-8406-002248e10de6",
        "mspp_associatecurrentportaluser":  false,
        "mspp_redirecturlquerystringattribute":  null,
        "mspp_referenceentityprimarykeylogicalname":  null,
        "_mspp_entitysourcestep_value":  null,
        "mspp_referenceentityrelationshipname":  null,
        "mspp_targetentityportaluserlookupattribute":  null,
        "_mspp_previousstep_value":  null,
        "mspp_title":  null,
        "mspp_multiplerecordsperuserpermitted":  false,
        "mspp_referenceentitylogicalname":  null,
        "mspp_maximumnooffiles":  null,
        "mspp_geolocation_formattedaddressfieldname":  null,
        "mspp_successmessage":  null,
        "mspp_editexistingrecordpermitted":  false,
        "mspp_geolocation_postalcodefieldname":  null,
        "mspp_submitbuttonbusytext":  null,
        "mspp_referencequeryattributelogicalname":  null,
        "mspp_recordsourcerelationshipname":  null,
        "mspp_referencequerystringisprimarykey":  true,
        "mspp_geolocation_enabled":  false,
        "mspp_savedeventkeyname":  null,
        "mspp_attachfiletypeerrormessage":  null,
        "_mspp_webform_value":  "a55b17a6-d4dc-f011-8406-002248e10de6",
        "mspp_movepreviouspermitted":  true,
        "mspp_tooltipenabled":  false,
        "mspp_redirecturl":  null,
        "_mspp_redirectwebpage_value":  null,
        "mspp_previousbuttoncssclass":  null,
        "mspp_geolocation_maptype":  756150000,
        "mspp_createautonumber":  false,
        "mspp_attachfilesizeerrormessage":  null,
        "mspp_provisionedlanguages":  null,
        "mspp_geolocation_countyfieldname":  null,
        "mspp_userhostaddressattributelogicalname":  null,
        "mspp_instructions":  null,
        "mspp_submitbuttoncssclass":  null,
        "mspp_primarykeyquerystringparametername":  "id",
        "mspp_validationsummarylinksenabled":  true,
        "_mspp_conditiondefaultnextstep_value":  null,
        "mspp_storageaccountname":  null,
        "mspp_geolocation_neighborhoodfieldname":  null,
        "mspp_type":  100000001,
        "mspp_entitysourcetype":  100000001,
        "mspp_validationsummarycssclass":  null,
        "mspp_modifiedon":  "2025-12-19T12:18:44Z",
        "mspp_referenceentityshowreadonlyform":  false,
        "mspp_attachfilemaxsize":  null,
        "mspp_mode":  100000001,
        "mspp_autonumberdefinitionname":  null,
        "mspp_geolocation_addresslinefieldname":  null,
        "mspp_validationgroup":  null,
        "mspp_geolocation_latitudefieldname":  null,
        "mspp_allowmultiplefiles":  false,
        "mspp_primarykeyattributelogicalname":  "msdyn_appointmentrequestid",
        "mspp_postbackurl":  null,
        "_mspp_createdby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_portaluserlookupattributeisactivityparty":  false,
        "mspp_geolocation_statefieldname":  null,
        "mspp_redirecturlquerystringname":  null,
        "mspp_name":  "Scheduling",
        "mspp_populatereferenceentitylookupfield":  false
    },
    {
        "mspp_attachfilerequirederrormessage":  null,
        "mspp_tabname":  null,
        "mspp_appendquerystring":  false,
        "mspp_forceallfieldsrequired":  false,
        "mspp_referencetargetlookupattributelogicalname":  null,
        "mspp_targetentitylogicalname":  "msdyn_appointmentrequest",
        "mspp_loguser":  false,
        "mspp_referencesourceentitylogicalname":  null,
        "mspp_nextbuttontext":  null,
        "mspp_renderwebresourcesinline":  false,
        "mspp_useridentitynameattributelogicalname":  null,
        "mspp_webformstepid":  "8f5a17a6-d4dc-f011-8406-002248e10de6",
        "_mspp_modifiedby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_autogeneratesteps":  false,
        "mspp_createdon":  "2025-12-19T12:17:14Z",
        "mspp_editexpiredstatecode":  null,
        "mspp_submiteventkeyname":  null,
        "mspp_redirecturlcustomquerystring":  null,
        "mspp_nextbuttoncssclass":  "btn button1",
        "mspp_accept":  null,
        "mspp_movepreviouseventkeyname":  null,
        "mspp_captcharequired":  false,
        "mspp_referenceentityreadonlyformname":  "",
        "mspp_formname":  "Create an appointment Step 3",
        "mspp_validationsummaryheadertext":  null,
        "mspp_referenceentitysourcetype":  100000001,
        "mspp_referencerecordsourcerelationshipname":  null,
        "mspp_savingeventkeyname":  null,
        "mspp_condition":  null,
        "_mspp_referenceentitystep_value":  null,
        "mspp_autonumberattributelogicalname":  null,
        "mspp_settings":  "{\"$type\":\"Adxstudio.Xrm.Web.UI.JsonConfiguration.FormActionMetadata, Adxstudio.Xrm\",\"Actions\":[],\"DeleteDialog\":{\"$type\":\"Adxstudio.Xrm.Web.UI.JsonConfiguration.DeleteModal, Adxstudio.Xrm\",\"Title\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"PrimaryButtonText\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"CloseButtonText\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"DismissButtonSrText\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"Size\":0,\"CssClass\":\"\",\"TitleCssClass\":\"\",\"PrimaryButtonCssClass\":\"\",\"CloseButtonCssClass\":\"\"},\"WorkflowDialog\":{\"$type\":\"Adxstudio.Xrm.Web.UI.JsonConfiguration.WorkflowModal, Adxstudio.Xrm\",\"Title\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"PrimaryButtonText\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"CloseButtonText\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"DismissButtonSrText\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"Size\":0,\"CssClass\":\"\",\"TitleCssClass\":\"\",\"PrimaryButtonCssClass\":\"\",\"CloseButtonCssClass\":\"\"},\"ActionDropDownButtonLabel\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"TopContainerCssClass\":\"\",\"BottomContainerCssClass\":\"\",\"ActivateDialog\":{\"$type\":\"Adxstudio.Xrm.Web.UI.JsonConfiguration.ActivateModal,\\tAdxstudio.Xrm\",\"Title\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"PrimaryButtonText\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"CloseButtonText\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"DismissButtonSrText\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"Size\":0,\"CssClass\":\"\",\"TitleCssClass\":\"\",\"PrimaryButtonCssClass\":\"\",\"CloseButtonCssClass\":\"\"},\"DeactivateDialog\":{\"$type\":\"Adxstudio.Xrm.Web.UI.JsonConfiguration.DeactivateModal,\\tAdxstudio.Xrm\",\"Title\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"PrimaryButtonText\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"CloseButtonText\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"DismissButtonSrText\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"Size\":0,\"CssClass\":\"\",\"TitleCssClass\":\"\",\"PrimaryButtonCssClass\":\"\",\"CloseButtonCssClass\":\"\"},\"CreateRelatedRecordDialog\":{\"$type\":\"Adxstudio.Xrm.Web.UI.JsonConfiguration.CreateRelatedRecordModal, Adxstudio.Xrm\",\"PrimaryButtonText\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"CloseButtonText\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"PrimaryButtonCssClass\":\"\",\"CloseButtonCssClass\":\"\",\"Title\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"DismissButtonSrText\":[{\"$type\":\"Adxstudio.Xrm.Web.UI.WebForms.LanguageResources, Adxstudio.Xrm\",\"LCID\":1033,\"Value\":\"\"}],\"Size\":0,\"CssClass\":\"\",\"TitleCssClass\":\"\"}}",
        "mspp_usercontrolpath":  null,
        "mspp_previousbuttontext":  null,
        "mspp_editexpiredstatusreason":  null,
        "mspp_hideformonsuccess":  true,
        "mspp_showunsupportedfields":  false,
        "mspp_attachfilerequired":  false,
        "mspp_entitypermissionsenabled":  true,
        "mspp_showownerfields":  false,
        "mspp_attachfilelabel":  null,
        "mspp_usercontroltitle":  "",
        "mspp_targetentityprimarykeylogicalname":  null,
        "mspp_attachfilestoragelocation":  null,
        "mspp_submitbuttontext":  null,
        "mspp_recordnotfoundmessage":  null,
        "mspp_redirecturlappendentityidquerystring":  false,
        "mspp_containername":  null,
        "statecode":  0,
        "mspp_redirecturlquerystringattributeparamname":  null,
        "mspp_geolocation_longitudefieldname":  null,
        "mspp_attachfile":  false,
        "mspp_geolocation_displaymap":  false,
        "mspp_setentityreference":  false,
        "mspp_referencequerystringname":  null,
        "mspp_geolocation_cityfieldname":  null,
        "mspp_editnotpermittedmessage":  null,
        "mspp_editexpiredmessage":  null,
        "mspp_showcaptchaforauthenticatedusers":  false,
        "mspp_loadeventkeyname":  null,
        "mspp_recommendedfieldsrequired":  false,
        "mspp_geolocation_countryfieldname":  null,
        "mspp_registerstartupscript":  "$(function () {\r\n\r\n\r\n    if (typeof (Page_Validators) != \u0027undefined\u0027) {\r\n        var newValidator1 = document.createElement(\u0027span\u0027);\r\n        newValidator1.style.display = \"none\";\r\n        newValidator1.id = \"RepValidator\";\r\n        newValidator1.controltovalidate = \"representative_label\";\r\n        newValidator1.errormessage = \"\u003ca href=\u0027#representative_label\u0027\u003ePlease select a represenative.\u003c/a\u003e\";\r\n        newValidator1.validationGroup = \"\";\r\n        newValidator1.initialvalue = \"\";\r\n        newValidator1.evaluationfunction = function () {\r\n            if($(\"#msdyn_specificrepresentative input[type=\u0027radio\u0027]:checked\").val() == 192350000) {\r\n                return $(\"input[type=\u0027radio\u0027][name=\u0027representative\u0027]:checked\").length \u003e 0;\r\n            }\r\n            return true;\r\n        };\r\n        Page_Validators.push(newValidator1);\r\n    }\r\n    \r\n    const locationRecordId = $(\"#msdyn_location\").val();\r\n    $(\u0027[data-name=\"location-section\"]\u0027).parent().hide();\r\n\r\n    $(\u0027[data-name=\"bank-rep-lookup-section\"]\u0027).parent().hide();\r\n\r\n    $(\u0027[data-name=\"bank-rep-selection\"]\u0027).parent().hide();\r\n\r\n    $(\u0027[data-name=\"General_section_7\"]\u0027).parent().hide();\r\n \r\n    (function (webapi, $) {\r\n        function safeAjax(ajaxOptions) {\r\n            var deferredAjax = $.Deferred();\r\n            shell.getTokenDeferred().done(function (token) {\r\n                // Add headers for ajax\r\n                if (!ajaxOptions.headers) {\r\n                    $.extend(ajaxOptions, {\r\n                        headers: {\r\n                            \"__RequestVerificationToken\": token\r\n                        }\r\n                    });\r\n                } else {\r\n                    ajaxOptions.headers[\"__RequestVerificationToken\"] = token;\r\n                }\r\n                $.ajax(ajaxOptions)\r\n                    .done(function (data, textStatus, jqXHR) {\r\n                        validateLoginSession(data, textStatus, jqXHR, deferredAjax.resolve);\r\n                    }).fail(deferredAjax.reject); //ajax\r\n            }).fail(function () {\r\n                deferredAjax.rejectWith(this, arguments); // On token failure pass the token ajax and args\r\n            });\r\n            return deferredAjax.promise();\r\n        }\r\n        webapi.safeAjax = safeAjax;\r\n    })(window.webapi = window.webapi || {}, jQuery)\r\n\r\n    function appAjax(processingMsg, ajaxOptions) {\r\n        return webapi.safeAjax(ajaxOptions)\r\n        .fail(function (response) {\r\n            if (response.responseJSON) {\r\n                alert(\"Error: \" + response.responseJSON.error.message)\r\n            } else {\r\n                alert(\"Error: Web API is not available... \")\r\n            }\r\n        });\r\n    }\r\n\r\n    function loadLocation() {\r\n        return appAjax(\u0027Loading...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/msdyn_locations(${locationRecordId})?$select=msdyn_branchaddress,msdyn_name`,\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    loadLocation().done(function (data) {\r\n        initializeLocation(data)\r\n    });\r\n\r\n    function initializeLocation({msdyn_name, msdyn_branchaddress}) {\r\n        $(\u0027[data-name=\"main-section\"] \u003e tbody\u0027).prepend(\u0027\u003ctr\u003e\u003ctd class=\"clearfix cell\"\u003e\u003ch4 class=\"locationNameFieldContent\"\u003e\u0027 + msdyn_name + \u0027\u003c/h4\u003e\u003ch4 class=\"locationAddressFieldContent\"\u003e\u0027 + msdyn_branchaddress + \u0027\u003c/h4\u003e\u003c/td\u003e\u003c/tr\u003e\u0027);\r\n    }\r\n\r\n\r\n    $(\u0027#msdyn_specificrepresentative input[type=\"radio\"]\u0027).change(function() {\r\n        const selectedRadio = $(this).filter(\u0027:checked\u0027).eq(0);\r\n        if(selectedRadio.val() == \u0027192350000\u0027) {\r\n            getContactsAtBank().done(function (data) {\r\n                $(\u0027[data-name=\"bank-rep-selection\"]\u0027).parent().show();\r\n                showReps(data.value);\r\n            });\r\n        } else {\r\n            $(\u0027[data-name=\"bank-rep-selection\"]\u0027).parent().hide();\r\n        }\r\n    });\r\n\r\n    function getContactsAtBank() {\r\n        return appAjax(\u0027Loading...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/contacts?$expand=msdynce_Contact_msdyn_Service_msdyn_Service\u0026$filter=_msdynce_bankbranchcode_value%20eq%20${locationRecordId}`,\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    function showReps(contacts) {\r\n        let contactsWithRequiredSpeciality = surya = contacts.filter(contact =\u003e {\r\n            let opt = contact.msdynce_Contact_msdyn_Service_msdyn_Service.some((\r\n                { msdyn_serviceid }) =\u003e msdyn_serviceid == $(\"#msdyn_services\").val());\r\n            return opt;\r\n        });\r\n\r\n        let allInputs = \u0027\u0027;\r\n        contactsWithRequiredSpeciality.forEach((contact, index) =\u003e allInputs += `\r\n            \u003cinput\r\n                id=\"representative_${index}\" type=\"radio\"\r\n                name=\"representative\"\r\n                data-name=\"${contact.fullname}\"\r\n                value=\"${contact.contactid}\" /\u003e\r\n            \u003clabel for=\"representative_${index}\"\u003e\r\n                \u003cspan class=\"sr-only\"\u003eSelect a Specialist\u003c/span\u003e\r\n                ${contact.fullname}\r\n            \u003c/label\u003e\r\n            \u003cbr /\u003e\r\n        `);\r\n\r\n        $(\u0027[data-name=\"bank-rep-selection\"] \u003e tbody \u003e tr\u0027).eq(0).attr(\"colspan\", \"1\").attr(\"rowspan\", \"1\")\r\n        $(\u0027[data-name=\"bank-rep-selection\"] \u003e tbody \u003e tr\u0027).eq(0).html(`\r\n            \u003ctd class=\"clearfix cell picklist-cell\"\u003e\r\n                \u003cdiv class=\"info\"\u003e\r\n                    \u003clabel id=\"representative_label\" class=\"field-label\"\u003e\r\n                        Select a Specialist\r\n                    \u003c/label\u003e\r\n                    \u003cdiv class=\"validators\"\u003e\u003c/div\u003e\r\n                    \u003c/div\u003e\r\n                    \u003cdiv class=\"control\"\u003e\r\n                    \u003cspan id=\"representative-list\"\r\n                        class=\"picklist vertical representative\" role=\"presentation\"\u003e\r\n                        ${allInputs}\r\n                    \u003c/span\u003e\r\n                \u003c/div\u003e\r\n            \u003c/td\u003e\r\n        `\r\n        )\r\n\r\n        $(\u0027#representative-list input[type=\"radio\"]\u0027).change(function() {\r\n            const selectedRadio = $(this).filter(\u0027:checked\u0027).eq(0);\r\n            $(\"#msdyn_bankrepcontact_name\").val(selectedRadio.attr(\u0027data-name\u0027));\r\n            $(\"#msdyn_bankrepcontact\").val(selectedRadio.val());\r\n            $(\"#msdyn_bankrepcontact_entityname\").val(\"contact\");\r\n        });\r\n    }\r\n});",
        "statuscode":  1,
        "mspp_attachfilerestrictaccept":  false,
        "mspp_validationsummarylinktext":  null,
        "_mspp_nextstep_value":  "ed5a17a6-d4dc-f011-8406-002248e10de6",
        "mspp_associatecurrentportaluser":  false,
        "mspp_redirecturlquerystringattribute":  null,
        "mspp_referenceentityprimarykeylogicalname":  null,
        "_mspp_entitysourcestep_value":  "32ec11b2-d4dc-f011-8406-002248e10de6",
        "mspp_referenceentityrelationshipname":  null,
        "mspp_targetentityportaluserlookupattribute":  null,
        "_mspp_previousstep_value":  null,
        "mspp_title":  "[{\"LCID\":1033,\"Value\":\"\u003ch3\u003e3. Disponibilidad\u003c/h3\u003e\"}]",
        "mspp_multiplerecordsperuserpermitted":  false,
        "mspp_referenceentitylogicalname":  null,
        "mspp_maximumnooffiles":  null,
        "mspp_geolocation_formattedaddressfieldname":  null,
        "mspp_successmessage":  null,
        "mspp_editexistingrecordpermitted":  false,
        "mspp_geolocation_postalcodefieldname":  null,
        "mspp_submitbuttonbusytext":  null,
        "mspp_referencequeryattributelogicalname":  null,
        "mspp_recordsourcerelationshipname":  null,
        "mspp_referencequerystringisprimarykey":  true,
        "mspp_geolocation_enabled":  false,
        "mspp_savedeventkeyname":  null,
        "mspp_attachfiletypeerrormessage":  null,
        "_mspp_webform_value":  "925a17a6-d4dc-f011-8406-002248e10de6",
        "mspp_movepreviouspermitted":  true,
        "mspp_tooltipenabled":  false,
        "mspp_redirecturl":  null,
        "_mspp_redirectwebpage_value":  null,
        "mspp_previousbuttoncssclass":  "btn button2",
        "mspp_geolocation_maptype":  756150000,
        "mspp_createautonumber":  false,
        "mspp_attachfilesizeerrormessage":  null,
        "mspp_provisionedlanguages":  null,
        "mspp_geolocation_countyfieldname":  null,
        "mspp_userhostaddressattributelogicalname":  null,
        "mspp_instructions":  null,
        "mspp_submitbuttoncssclass":  null,
        "mspp_primarykeyquerystringparametername":  null,
        "mspp_validationsummarylinksenabled":  true,
        "_mspp_conditiondefaultnextstep_value":  null,
        "mspp_storageaccountname":  null,
        "mspp_geolocation_neighborhoodfieldname":  null,
        "mspp_type":  100000001,
        "mspp_entitysourcetype":  100000003,
        "mspp_validationsummarycssclass":  null,
        "mspp_modifiedon":  "2025-12-19T12:18:45Z",
        "mspp_referenceentityshowreadonlyform":  false,
        "mspp_attachfilemaxsize":  null,
        "mspp_mode":  100000001,
        "mspp_autonumberdefinitionname":  null,
        "mspp_geolocation_addresslinefieldname":  null,
        "mspp_validationgroup":  null,
        "mspp_geolocation_latitudefieldname":  null,
        "mspp_allowmultiplefiles":  false,
        "mspp_primarykeyattributelogicalname":  null,
        "mspp_postbackurl":  null,
        "_mspp_createdby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_portaluserlookupattributeisactivityparty":  false,
        "mspp_geolocation_statefieldname":  null,
        "mspp_redirecturlquerystringname":  null,
        "mspp_name":  "3. Availability",
        "mspp_populatereferenceentitylookupfield":  false
    },
    {
        "mspp_attachfilerequirederrormessage":  null,
        "mspp_tabname":  null,
        "mspp_appendquerystring":  false,
        "mspp_forceallfieldsrequired":  false,
        "mspp_referencetargetlookupattributelogicalname":  null,
        "mspp_targetentitylogicalname":  "msdyn_appointmentrequest",
        "mspp_loguser":  false,
        "mspp_referencesourceentitylogicalname":  null,
        "mspp_nextbuttontext":  null,
        "mspp_renderwebresourcesinline":  false,
        "mspp_useridentitynameattributelogicalname":  null,
        "mspp_webformstepid":  "ed5a17a6-d4dc-f011-8406-002248e10de6",
        "_mspp_modifiedby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_autogeneratesteps":  false,
        "mspp_createdon":  "2025-12-19T12:17:16Z",
        "mspp_editexpiredstatecode":  null,
        "mspp_submiteventkeyname":  null,
        "mspp_redirecturlcustomquerystring":  null,
        "mspp_nextbuttoncssclass":  "btn button1",
        "mspp_accept":  null,
        "mspp_movepreviouseventkeyname":  null,
        "mspp_captcharequired":  false,
        "mspp_referenceentityreadonlyformname":  "",
        "mspp_formname":  "Create an Appointment Step 4",
        "mspp_validationsummaryheadertext":  null,
        "mspp_referenceentitysourcetype":  100000001,
        "mspp_referencerecordsourcerelationshipname":  null,
        "mspp_savingeventkeyname":  null,
        "mspp_condition":  null,
        "_mspp_referenceentitystep_value":  null,
        "mspp_autonumberattributelogicalname":  null,
        "mspp_settings":  null,
        "mspp_usercontrolpath":  null,
        "mspp_previousbuttontext":  null,
        "mspp_editexpiredstatusreason":  null,
        "mspp_hideformonsuccess":  true,
        "mspp_showunsupportedfields":  false,
        "mspp_attachfilerequired":  false,
        "mspp_entitypermissionsenabled":  true,
        "mspp_showownerfields":  false,
        "mspp_attachfilelabel":  null,
        "mspp_usercontroltitle":  "",
        "mspp_targetentityprimarykeylogicalname":  null,
        "mspp_attachfilestoragelocation":  null,
        "mspp_submitbuttontext":  null,
        "mspp_recordnotfoundmessage":  null,
        "mspp_redirecturlappendentityidquerystring":  false,
        "mspp_containername":  null,
        "statecode":  0,
        "mspp_redirecturlquerystringattributeparamname":  null,
        "mspp_geolocation_longitudefieldname":  null,
        "mspp_attachfile":  false,
        "mspp_geolocation_displaymap":  false,
        "mspp_setentityreference":  false,
        "mspp_referencequerystringname":  null,
        "mspp_geolocation_cityfieldname":  null,
        "mspp_editnotpermittedmessage":  null,
        "mspp_editexpiredmessage":  null,
        "mspp_showcaptchaforauthenticatedusers":  false,
        "mspp_loadeventkeyname":  null,
        "mspp_recommendedfieldsrequired":  false,
        "mspp_geolocation_countryfieldname":  null,
        "mspp_registerstartupscript":  "$(function() {\r\n    $(\u0027[data-name=\"hidden-section\"]\u0027).parent().hide();\r\n    sessionStorage.setItem(\"BankRep\", $(\"#msdyn_bankrepcontact\").val());\r\n\r\n    if($(\"#msdynce_selectedtimeslot\").val() == \u0027\u0027) sessionStorage.removeItem(\"selectedDateTime\");\r\n\r\n    calendarLoad(checkIfIframeLoaded);\r\n\r\n    if (typeof (Page_Validators) != \u0027undefined\u0027) {\r\n\r\n        var newValidator1 = document.createElement(\u0027span\u0027);\r\n        newValidator1.style.display = \"none\";\r\n        newValidator1.id = \"RepValidator\";\r\n        newValidator1.controltovalidate = \"WebResource_TimeSlotSelector\";\r\n        newValidator1.errormessage = \"\u003ca href=\u0027#WebResource_TimeSlotSelector\u0027\u003ePlease select a time slot.\u003c/a\u003e\";\r\n        newValidator1.validationGroup = \"\";\r\n        newValidator1.initialvalue = \"\";\r\n        newValidator1.evaluationfunction = function () {\r\n            if($(\"#msdynce_selectedtimeslot\").val() == \u0027\u0027 || $(\"#msdynce_selectedtimeslot\").val() == null) {\r\n                return false;\r\n            }\r\n            return true;\r\n        };\r\n        Page_Validators.push(newValidator1);\r\n    }\r\n});\r\n\r\n\r\nfunction calendarLoad(callback){\r\n    var iframe = $(\u0027#WebResource_TimeSlotSelector\u0027).attr(\u0027aria-label\u0027, \u0027none\u0027);    \r\n    iframe.on(\u0027load\u0027, function() {        \r\n        callback(this);\r\n    });\r\n}\r\n\r\nfunction checkIfIframeLoaded(iframe) {\r\n    var iframeDoc = iframe.contentDocument || iframe.contentWindow.document;\r\n    var radioSlotObj = $(\"input[name=\u0027time\u0027]\", iframeDoc).attr(\u0027aria-label\u0027, \u0027none\u0027);\r\n    var dateSlotObj = $(\"input[name=\u0027weekview\u0027]\", iframeDoc).attr(\u0027aria-label\u0027, \u0027none\u0027);\r\n    $(\u0027button.leftLst\u0027, iframeDoc).attr(\u0027aria-label\u0027, \u0027none\u0027);\r\n    $(\u0027button.rightLst\u0027, iframeDoc).attr(\u0027aria-label\u0027, \u0027none\u0027);\r\n\r\n    if(radioSlotObj != undefined){\r\n        radioSlotObj.click(function() {\r\n            var dateValueNext, timeValueNext;\r\n            var radioDateVal = $(\"input[name=\u0027weekview\u0027]:checked\", iframeDoc).attr(\u0027aria-label\u0027, \u0027none\u0027);\r\n            if(radioDateVal != undefined){\r\n                dateValueNext = radioDateVal.next(\"div.day-date\").find(\".slotDate\").text();\r\n                var radioSlotVal = $(\"input[name=\u0027time\u0027]:checked\", iframeDoc).attr(\u0027aria-label\u0027, \u0027none\u0027);\r\n                if(radioSlotVal != undefined){\r\n                    timeValueNext = radioSlotVal.next(\"div.time\").find(\"em\").text();\r\n                    var startDate = moment(dateValueNext + \" \" + timeValueNext).format(\u0027MM/DD/YYYY h:mm a\u0027);\r\n                    var endDate = moment(startDate).add(1, \u0027hours\u0027).format(\u0027MM/DD/YYYY h:mm a\u0027);\r\n                    setDateControlFieldValue(\"msdynce_scheduledstart\",startDate);\r\n                    setDateControlFieldValue(\"msdynce_scheduledend\", endDate); \r\n                    sessionStorage.setItem(\"selectedDateTime\",  moment(dateValueNext + \" \" + timeValueNext).format(\u0027MMM DD hh:mm a\u0027));\r\n                    $(\"#msdynce_selectedtimeslot\").val( moment(dateValueNext + \" \" + timeValueNext).format(\u0027MMM DD, YYYY | hh:mm A\u0027));\r\n                }\r\n            }\r\n        });  \r\n    }\r\n}\r\n\r\nfunction setDateControlFieldValue(fieldname,d){\r\n   //debugger;\r\n   var datefield = $(\u0027#\u0027+ fieldname);\r\n   var inputControl = $(\u0027#\u0027+ fieldname +\u0027_datepicker_description\u0027);\r\n   var dateFormat = inputControl.attr(\u0027data-date-format\u0027);\r\n   var dateVal = Date.parse(d);\r\n   var dateUTC = moment(dateVal).utc();\r\n\r\n   datefield.val(dateUTC.format(\u0027YYYY-MM-DDTHH:mm:ss.0000000\\\\Z\u0027));   \r\n   inputControl.val(dateUTC.format(dateFormat));\r\n}\r\n\r\nfunction setEmailRange(){}",
        "statuscode":  1,
        "mspp_attachfilerestrictaccept":  false,
        "mspp_validationsummarylinktext":  null,
        "_mspp_nextstep_value":  "8e5b17a6-d4dc-f011-8406-002248e10de6",
        "mspp_associatecurrentportaluser":  false,
        "mspp_redirecturlquerystringattribute":  null,
        "mspp_referenceentityprimarykeylogicalname":  null,
        "_mspp_entitysourcestep_value":  "32ec11b2-d4dc-f011-8406-002248e10de6",
        "mspp_referenceentityrelationshipname":  null,
        "mspp_targetentityportaluserlookupattribute":  null,
        "_mspp_previousstep_value":  null,
        "mspp_title":  "[{\"LCID\":1033,\"Value\":\"\u003ch3\u003e4. Programación\u003c/h3\u003e\"}]",
        "mspp_multiplerecordsperuserpermitted":  false,
        "mspp_referenceentitylogicalname":  null,
        "mspp_maximumnooffiles":  null,
        "mspp_geolocation_formattedaddressfieldname":  null,
        "mspp_successmessage":  null,
        "mspp_editexistingrecordpermitted":  false,
        "mspp_geolocation_postalcodefieldname":  null,
        "mspp_submitbuttonbusytext":  null,
        "mspp_referencequeryattributelogicalname":  null,
        "mspp_recordsourcerelationshipname":  null,
        "mspp_referencequerystringisprimarykey":  true,
        "mspp_geolocation_enabled":  false,
        "mspp_savedeventkeyname":  null,
        "mspp_attachfiletypeerrormessage":  null,
        "_mspp_webform_value":  "925a17a6-d4dc-f011-8406-002248e10de6",
        "mspp_movepreviouspermitted":  true,
        "mspp_tooltipenabled":  false,
        "mspp_redirecturl":  null,
        "_mspp_redirectwebpage_value":  null,
        "mspp_previousbuttoncssclass":  "btn button2",
        "mspp_geolocation_maptype":  756150000,
        "mspp_createautonumber":  false,
        "mspp_attachfilesizeerrormessage":  null,
        "mspp_provisionedlanguages":  null,
        "mspp_geolocation_countyfieldname":  null,
        "mspp_userhostaddressattributelogicalname":  null,
        "mspp_instructions":  null,
        "mspp_submitbuttoncssclass":  null,
        "mspp_primarykeyquerystringparametername":  null,
        "mspp_validationsummarylinksenabled":  true,
        "_mspp_conditiondefaultnextstep_value":  null,
        "mspp_storageaccountname":  null,
        "mspp_geolocation_neighborhoodfieldname":  null,
        "mspp_type":  100000001,
        "mspp_entitysourcetype":  100000003,
        "mspp_validationsummarycssclass":  null,
        "mspp_modifiedon":  "2025-12-19T12:18:47Z",
        "mspp_referenceentityshowreadonlyform":  false,
        "mspp_attachfilemaxsize":  null,
        "mspp_mode":  100000001,
        "mspp_autonumberdefinitionname":  null,
        "mspp_geolocation_addresslinefieldname":  null,
        "mspp_validationgroup":  null,
        "mspp_geolocation_latitudefieldname":  null,
        "mspp_allowmultiplefiles":  false,
        "mspp_primarykeyattributelogicalname":  null,
        "mspp_postbackurl":  null,
        "_mspp_createdby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_portaluserlookupattributeisactivityparty":  false,
        "mspp_geolocation_statefieldname":  null,
        "mspp_redirecturlquerystringname":  null,
        "mspp_name":  "4. Scheduling",
        "mspp_populatereferenceentitylookupfield":  false
    },
    {
        "mspp_attachfilerequirederrormessage":  null,
        "mspp_tabname":  null,
        "mspp_appendquerystring":  false,
        "mspp_forceallfieldsrequired":  false,
        "mspp_referencetargetlookupattributelogicalname":  null,
        "mspp_targetentitylogicalname":  "msdyn_appointmentrequest",
        "mspp_loguser":  false,
        "mspp_referencesourceentitylogicalname":  null,
        "mspp_nextbuttontext":  null,
        "mspp_renderwebresourcesinline":  false,
        "mspp_useridentitynameattributelogicalname":  null,
        "mspp_webformstepid":  "8e5b17a6-d4dc-f011-8406-002248e10de6",
        "_mspp_modifiedby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_autogeneratesteps":  false,
        "mspp_createdon":  "2025-12-19T12:17:20Z",
        "mspp_editexpiredstatecode":  null,
        "mspp_submiteventkeyname":  null,
        "mspp_redirecturlcustomquerystring":  null,
        "mspp_nextbuttoncssclass":  "btn button1",
        "mspp_accept":  null,
        "mspp_movepreviouseventkeyname":  null,
        "mspp_captcharequired":  false,
        "mspp_referenceentityreadonlyformname":  "",
        "mspp_formname":  "Create an Appointment Step 5",
        "mspp_validationsummaryheadertext":  null,
        "mspp_referenceentitysourcetype":  100000001,
        "mspp_referencerecordsourcerelationshipname":  null,
        "mspp_savingeventkeyname":  null,
        "mspp_condition":  null,
        "_mspp_referenceentitystep_value":  null,
        "mspp_autonumberattributelogicalname":  null,
        "mspp_settings":  null,
        "mspp_usercontrolpath":  null,
        "mspp_previousbuttontext":  null,
        "mspp_editexpiredstatusreason":  null,
        "mspp_hideformonsuccess":  true,
        "mspp_showunsupportedfields":  false,
        "mspp_attachfilerequired":  false,
        "mspp_entitypermissionsenabled":  true,
        "mspp_showownerfields":  false,
        "mspp_attachfilelabel":  null,
        "mspp_usercontroltitle":  "",
        "mspp_targetentityprimarykeylogicalname":  null,
        "mspp_attachfilestoragelocation":  null,
        "mspp_submitbuttontext":  null,
        "mspp_recordnotfoundmessage":  null,
        "mspp_redirecturlappendentityidquerystring":  false,
        "mspp_containername":  null,
        "statecode":  0,
        "mspp_redirecturlquerystringattributeparamname":  null,
        "mspp_geolocation_longitudefieldname":  null,
        "mspp_attachfile":  false,
        "mspp_geolocation_displaymap":  false,
        "mspp_setentityreference":  false,
        "mspp_referencequerystringname":  null,
        "mspp_geolocation_cityfieldname":  null,
        "mspp_editnotpermittedmessage":  null,
        "mspp_editexpiredmessage":  null,
        "mspp_showcaptchaforauthenticatedusers":  false,
        "mspp_loadeventkeyname":  null,
        "mspp_recommendedfieldsrequired":  true,
        "mspp_geolocation_countryfieldname":  null,
        "mspp_registerstartupscript":  "$(function(){\r\n    $(\u0027[data-name=\"name-section\"]\u0027).parent().hide();\r\n})",
        "statuscode":  1,
        "mspp_attachfilerestrictaccept":  false,
        "mspp_validationsummarylinktext":  null,
        "_mspp_nextstep_value":  "110510ac-d4dc-f011-8406-002248e10de6",
        "mspp_associatecurrentportaluser":  false,
        "mspp_redirecturlquerystringattribute":  null,
        "mspp_referenceentityprimarykeylogicalname":  null,
        "_mspp_entitysourcestep_value":  "32ec11b2-d4dc-f011-8406-002248e10de6",
        "mspp_referenceentityrelationshipname":  null,
        "mspp_targetentityportaluserlookupattribute":  null,
        "_mspp_previousstep_value":  null,
        "mspp_title":  "[{\"LCID\":1033,\"Value\":\"\u003ch3\u003e5. Detalles\u003c/h3\u003e\"}]",
        "mspp_multiplerecordsperuserpermitted":  false,
        "mspp_referenceentitylogicalname":  null,
        "mspp_maximumnooffiles":  null,
        "mspp_geolocation_formattedaddressfieldname":  null,
        "mspp_successmessage":  null,
        "mspp_editexistingrecordpermitted":  false,
        "mspp_geolocation_postalcodefieldname":  null,
        "mspp_submitbuttonbusytext":  null,
        "mspp_referencequeryattributelogicalname":  null,
        "mspp_recordsourcerelationshipname":  null,
        "mspp_referencequerystringisprimarykey":  true,
        "mspp_geolocation_enabled":  false,
        "mspp_savedeventkeyname":  null,
        "mspp_attachfiletypeerrormessage":  null,
        "_mspp_webform_value":  "925a17a6-d4dc-f011-8406-002248e10de6",
        "mspp_movepreviouspermitted":  true,
        "mspp_tooltipenabled":  false,
        "mspp_redirecturl":  null,
        "_mspp_redirectwebpage_value":  null,
        "mspp_previousbuttoncssclass":  "btn button2",
        "mspp_geolocation_maptype":  756150000,
        "mspp_createautonumber":  false,
        "mspp_attachfilesizeerrormessage":  null,
        "mspp_provisionedlanguages":  null,
        "mspp_geolocation_countyfieldname":  null,
        "mspp_userhostaddressattributelogicalname":  null,
        "mspp_instructions":  null,
        "mspp_submitbuttoncssclass":  null,
        "mspp_primarykeyquerystringparametername":  null,
        "mspp_validationsummarylinksenabled":  true,
        "_mspp_conditiondefaultnextstep_value":  null,
        "mspp_storageaccountname":  null,
        "mspp_geolocation_neighborhoodfieldname":  null,
        "mspp_type":  100000001,
        "mspp_entitysourcetype":  100000003,
        "mspp_validationsummarycssclass":  null,
        "mspp_modifiedon":  "2025-12-19T12:18:50Z",
        "mspp_referenceentityshowreadonlyform":  false,
        "mspp_attachfilemaxsize":  null,
        "mspp_mode":  100000001,
        "mspp_autonumberdefinitionname":  null,
        "mspp_geolocation_addresslinefieldname":  null,
        "mspp_validationgroup":  null,
        "mspp_geolocation_latitudefieldname":  null,
        "mspp_allowmultiplefiles":  false,
        "mspp_primarykeyattributelogicalname":  null,
        "mspp_postbackurl":  null,
        "_mspp_createdby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_portaluserlookupattributeisactivityparty":  false,
        "mspp_geolocation_statefieldname":  null,
        "mspp_redirecturlquerystringname":  null,
        "mspp_name":  "5. Details",
        "mspp_populatereferenceentitylookupfield":  false
    },
    {
        "mspp_attachfilerequirederrormessage":  null,
        "mspp_tabname":  null,
        "mspp_appendquerystring":  false,
        "mspp_forceallfieldsrequired":  false,
        "mspp_referencetargetlookupattributelogicalname":  null,
        "mspp_targetentitylogicalname":  "msdyn_appointmentrequest",
        "mspp_loguser":  false,
        "mspp_referencesourceentitylogicalname":  null,
        "mspp_nextbuttontext":  null,
        "mspp_renderwebresourcesinline":  false,
        "mspp_useridentitynameattributelogicalname":  null,
        "mspp_webformstepid":  "e75b17a6-d4dc-f011-8406-002248e10de6",
        "_mspp_modifiedby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_autogeneratesteps":  false,
        "mspp_createdon":  "2025-12-19T12:17:22Z",
        "mspp_editexpiredstatecode":  null,
        "mspp_submiteventkeyname":  null,
        "mspp_redirecturlcustomquerystring":  null,
        "mspp_nextbuttoncssclass":  null,
        "mspp_accept":  null,
        "mspp_movepreviouseventkeyname":  null,
        "mspp_captcharequired":  false,
        "mspp_referenceentityreadonlyformname":  "",
        "mspp_formname":  "Create an Appointment Step 6",
        "mspp_validationsummaryheadertext":  null,
        "mspp_referenceentitysourcetype":  100000001,
        "mspp_referencerecordsourcerelationshipname":  null,
        "mspp_savingeventkeyname":  null,
        "mspp_condition":  null,
        "_mspp_referenceentitystep_value":  null,
        "mspp_autonumberattributelogicalname":  null,
        "mspp_settings":  null,
        "mspp_usercontrolpath":  null,
        "mspp_previousbuttontext":  null,
        "mspp_editexpiredstatusreason":  null,
        "mspp_hideformonsuccess":  true,
        "mspp_showunsupportedfields":  false,
        "mspp_attachfilerequired":  false,
        "mspp_entitypermissionsenabled":  true,
        "mspp_showownerfields":  false,
        "mspp_attachfilelabel":  null,
        "mspp_usercontroltitle":  "",
        "mspp_targetentityprimarykeylogicalname":  null,
        "mspp_attachfilestoragelocation":  null,
        "mspp_submitbuttontext":  null,
        "mspp_recordnotfoundmessage":  null,
        "mspp_redirecturlappendentityidquerystring":  false,
        "mspp_containername":  null,
        "statecode":  0,
        "mspp_redirecturlquerystringattributeparamname":  null,
        "mspp_geolocation_longitudefieldname":  null,
        "mspp_attachfile":  false,
        "mspp_geolocation_displaymap":  false,
        "mspp_setentityreference":  false,
        "mspp_referencequerystringname":  null,
        "mspp_geolocation_cityfieldname":  null,
        "mspp_editnotpermittedmessage":  null,
        "mspp_editexpiredmessage":  null,
        "mspp_showcaptchaforauthenticatedusers":  false,
        "mspp_loadeventkeyname":  null,
        "mspp_recommendedfieldsrequired":  false,
        "mspp_geolocation_countryfieldname":  null,
        "mspp_registerstartupscript":  "$(function() {\r\n    $(\u0027[data-name=\"info-lookup\"]\u0027).parent().hide();\r\n\r\n\r\n    const nextButtonContainer = $(\"#NextButton\").closest(\".entity-action-button\");\r\n    nextButtonContainer.after(\u0027\u003cdiv role=\"group\" class=\"btn-group entity-action-button\"\u003e\u003cinput type=\"button\" value=\"Submit\" id=\"SubmitButton\" class=\"btn btn-primary button next submit-btn\"\u003e\u003c/div\u003e\u0027);\r\n    $(\"#NextButton\").hide();\r\n\r\n    const descriptionElement = $(\"#msdynce_description\");\r\n\r\n    const dataObject = {};\r\n\r\n    dataObject[\"msdynce_firstname\"] = $(\"#msdynce_firstname\").val();\r\n    dataObject[\"msdynce_lastname\"] = $(\"#msdynce_lastname\").val();\r\n    dataObject[\"msdynce_emailaddress\"] = $(\"#msdynce_emailaddress\").val();\r\n    dataObject[\"msdynce_statuscancel\"] = 441790002;\r\n    dataObject[\"scheduledstart\"] = $(\"#msdynce_scheduledstart\").val();\r\n    dataObject[\"scheduledend\"] = $(\"#msdynce_scheduledend\").val();\r\n\r\n    const appointmentType = $(\"#msdyn_bankappointmenttype option:selected\").text()\r\n    dataObject[\"msdyn_bankappointmenttype\"] = $(\"#msdyn_bankappointmenttype option:selected\").val()\r\n    const timeSlot = $(\"#msdynce_selectedtimeslot\").val();\r\n    dataObject[\"msdynce_selectedtimeslot\"] = $(\"#msdynce_selectedtimeslot\").val();\r\n    \r\n    const branchRepId = $(\"#msdyn_bankrepcontact\").val();\r\n    if(branchRepId) {\r\n        dataObject[\"msdynce_contact_Appointment@odata.bind\"] = \"/contacts(\" + branchRepId + \")\";\r\n    }\r\n\r\n    (function (webapi, $) {\r\n        function safeAjax(ajaxOptions) {\r\n            var deferredAjax = $.Deferred();\r\n            shell.getTokenDeferred().done(function (token) {\r\n                // Add headers for ajax\r\n                if (!ajaxOptions.headers) {\r\n                    $.extend(ajaxOptions, {\r\n                        headers: {\r\n                            \"__RequestVerificationToken\": token\r\n                        }\r\n                    });\r\n                } else {\r\n                    ajaxOptions.headers[\"__RequestVerificationToken\"] = token;\r\n                }\r\n                $.ajax(ajaxOptions)\r\n                    .done(function (data, textStatus, jqXHR) {\r\n                        validateLoginSession(data, textStatus, jqXHR, deferredAjax.resolve);\r\n                    }).fail(deferredAjax.reject); //ajax\r\n            }).fail(function () {\r\n                deferredAjax.rejectWith(this, arguments); // On token failure pass the token ajax and args\r\n            });\r\n            return deferredAjax.promise();\r\n        }\r\n        webapi.safeAjax = safeAjax;\r\n    })(window.webapi = window.webapi || {}, jQuery)\r\n\r\n    function appAjax(processingMsg, ajaxOptions) {\r\n        return webapi.safeAjax(ajaxOptions)\r\n        .fail(function (response) {\r\n            if (response.responseJSON) {\r\n                alert(\"Error: \" + response.responseJSON.error.message)\r\n            } else {\r\n                alert(\"Error: Web API is not available... \")\r\n            }\r\n        });\r\n    }\r\n\r\n    function fetchService() {\r\n        const serviceId = $(\"#msdyn_services\").val();\r\n        dataObject[\"msdynce_Services_Appointment@odata.bind\"] = \"/msdyn_services(\" + serviceId + \")\";\r\n        return appAjax(\u0027Loading...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/msdyn_services(${serviceId})?$select=msdynce_servicesubcategory,msdyn_servicecategory`,\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    fetchService().done(function (data) {\r\n        $(\"#service-category\").text(data[\u0027msdyn_servicecategory@OData.Community.Display.V1.FormattedValue\u0027]);\r\n        $(\"#service-sub-category\").text(data[\u0027msdynce_servicesubcategory@OData.Community.Display.V1.FormattedValue\u0027]);\r\n    });\r\n\r\n    function fetchBranch() {\r\n        const branchId = $(\"#msdyn_location\").val();\r\n        dataObject[\"msdyn_Location_Appointment@odata.bind\"] = \"/msdyn_locations(\" + branchId + \")\";\r\n        return appAjax(\u0027Loading...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/msdyn_locations(${branchId})?$select=msdyn_name,msdyn_branchaddress`,\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    fetchBranch().done(function (data) {\r\n        if($(\"#msdyn_bankappointmenttype option:selected\").val() == 192350000) {\r\n            $(\"#bank-name\").text(data.msdyn_name);\r\n            $(\"#bank-address\").text(data.msdyn_branchaddress);\r\n        } else if($(\"#msdyn_bankappointmenttype option:selected\").val() == 192350001) {\r\n            $(\"#bank-name\").text(\u0027Conference software\u0027);\r\n            $(\"#bank-address\").html(\u0027\u003ca href=\"http://www.bankname.com/virtualmeeting/\" target=\"_blank\"\u003ehttp://www.bankname.com/virtualmeeting/\u003c/a\u003e\u0027);\r\n        }\r\n    });\r\n\r\n    function fetchBranchRep() {\r\n        return appAjax(\u0027Fetching branch rep details...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/contacts(${branchRepId})?$select=fullname,mobilephone`,\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    fetchBranchRep().done(function (data) {\r\n        $(\"#rep-name\").text(data.fullname);\r\n        $(\"#rep-phone\").text(data.mobilephone);\r\n    });\r\n\r\n    $(document).on(\u0027keyup\u0027, \u0027#description_text\u0027, function () {\r\n        $(\"#letterCountRow\").show();\r\n        const descriptionValue = $(this).val();\r\n        $(\"#letterCount\").text(descriptionValue.length);\r\n        descriptionElement.val(descriptionValue);\r\n    });\r\n\r\n    const reviewDetails = `\r\n    \u003ctd colspan=\"1\" rowspan=\"1\" class=\"clearfix cell\"\u003e\r\n        \u003cdiv class=\"tab-title\"\u003e\r\n            Appointment details\r\n            \u003cdiv class=\"edit-details\" id=\"editDetails\"\u003e\r\n            Edit\u003cimg src=\"/Icon_Edit_Pencil\"\u003e\r\n            \u003c/div\u003e\r\n        \u003c/div\u003e\r\n        \u003cdiv class=\"review-card\"\u003e\u003cspan class=\"apt-title\"\u003eWhy?\u003c/span\u003e\r\n            \u003cdiv class=\"apt-details\"\u003e\r\n            \u003cul\u003e\r\n                \u003cli id=\"service-category\"\u003e\u003c/li\u003e\r\n                \u003cli id=\"service-sub-category\"\u003e\u003c/li\u003e\r\n            \u003c/ul\u003e\r\n            \u003c/div\u003e\r\n        \u003c/div\u003e\r\n        \u003cdiv class=\"review-card\"\u003e\u003cspan class=\"apt-title\"\u003eHow?\u003c/span\u003e\r\n            \u003cdiv class=\"apt-details\"\u003e\r\n            \u003cul\u003e\r\n                \u003cli\u003e${appointmentType}\u003c/li\u003e\r\n                \u003cli id=\"bank-name\"\u003e\u003c/li\u003e\r\n                \u003cli id=\"bank-address\"\u003e\u003c/li\u003e\r\n            \u003c/ul\u003e\r\n            \u003c/div\u003e\r\n        \u003c/div\u003e\r\n        \u003cdiv class=\"review-card\"\u003e\u003cspan class=\"apt-title\"\u003eYou are meeting with\u003c/span\u003e\r\n            \u003cdiv class=\"apt-details\"\u003e\r\n            \u003cul\u003e\r\n                \u003cli id=\"rep-name\"\u003e\u003c/li\u003e\r\n                \u003cli id=\"rep-phone\"\u003e\u003c/li\u003e\r\n            \u003c/ul\u003e\r\n            \u003c/div\u003e\r\n            \u003cdiv class=\"edit-details\" style=\"display:none\"\u003eEdit\u003cimg src=\"/Icon_Edit_Pencil\"\u003e\u003c/div\u003e\r\n        \u003c/div\u003e\r\n        \u003cdiv class=\"review-card\"\u003e\u003cspan class=\"apt-title\"\u003eWhen?\u003c/span\u003e\r\n            \u003cdiv class=\"apt-details\"\u003e\r\n            \u003cul\u003e\r\n                \u003cli\u003e${timeSlot}\u003c/li\u003e\r\n                \u003cli\u003e(60 minutes)\u003c/li\u003e\r\n            \u003c/ul\u003e\r\n            \u003c/div\u003e\r\n            \u003cdiv class=\"edit-details\" style=\"display:none\"\u003eEdit\u003cimg src=\"/Icon_Edit_Pencil\"\u003e\u003c/div\u003e\r\n        \u003c/div\u003e\r\n        \u003cdiv class=\"custom-textarea clearfix\"\u003e\r\n            \u003cp\u003eIs there anything else you would like us to know?\u003c/p\u003e\r\n            \u003ctextarea maxlength=\"1000\" class=\"form-control customBox\" id=\"description_text\" style=\"resize: none;\"\r\n            placeholder=\"[This is a sample text] Let us know if there is something else you would like us to prepare for your appointment.\"\u003e\r\n            \u003c/textarea\u003e\r\n            \u003cspan id=\"letterCountRow\"\u003e\u003cspan id=\"letterCount\"\u003e\u003c/span\u003e/1,000\u003c/span\u003e\r\n        \u003c/div\u003e\r\n    \u003c/td\u003e`;\r\n\r\n    $(\u0027[data-name=\"main-section\"] tbody\u0027).find(\u0027tr\u0027).first().append(reviewDetails.text());\r\n    $(\u0027#description_text\u0027).val(descriptionElement.val());\r\n\r\n    $(\"#SubmitButton\").click(function() {\r\n        dataObject[\"description\"] = $(\"#msdynce_description\").val();\r\n        const speciality = $(\"#service-sub-category\").text();\r\n        const repName = $(\"#rep-name\").text();\r\n        const appointmentId = $(\"#msdyn_appointment\").val();\r\n        dataObject[\"subject\"] = `Chat about ${speciality} with ${repName}`;\r\n        appAjax(\u0027Loading...\u0027, {\r\n            type: \"PATCH\",\r\n            url: `/_api/appointments(${appointmentId})`,\r\n            contentType: \"application/json\",\r\n            data: JSON.stringify(dataObject),\r\n        }).done(function (res, status, xhr) {\r\n            $(\"#msdyn_appointment\").val(xhr.getResponseHeader(\"entityid\"));\r\n            $(\"#msdyn_appointment_entityname\").val(\"appointment\");\r\n            $(\"#msdyn_name\").val( dataObject[\"subject\"]);\r\n            $(\"#SubmitButton\").hide();\r\n            $(\"#NextButton\").show().click();\r\n        });\r\n    });\r\n});",
        "statuscode":  1,
        "mspp_attachfilerestrictaccept":  false,
        "mspp_validationsummarylinktext":  null,
        "_mspp_nextstep_value":  "a70410ac-d4dc-f011-8406-002248e10de6",
        "mspp_associatecurrentportaluser":  false,
        "mspp_redirecturlquerystringattribute":  null,
        "mspp_referenceentityprimarykeylogicalname":  null,
        "_mspp_entitysourcestep_value":  "a4ca19a0-d4dc-f011-8406-002248e10de6",
        "mspp_referenceentityrelationshipname":  null,
        "mspp_targetentityportaluserlookupattribute":  null,
        "_mspp_previousstep_value":  null,
        "mspp_title":  null,
        "mspp_multiplerecordsperuserpermitted":  false,
        "mspp_referenceentitylogicalname":  null,
        "mspp_maximumnooffiles":  null,
        "mspp_geolocation_formattedaddressfieldname":  null,
        "mspp_successmessage":  null,
        "mspp_editexistingrecordpermitted":  false,
        "mspp_geolocation_postalcodefieldname":  null,
        "mspp_submitbuttonbusytext":  null,
        "mspp_referencequeryattributelogicalname":  null,
        "mspp_recordsourcerelationshipname":  null,
        "mspp_referencequerystringisprimarykey":  true,
        "mspp_geolocation_enabled":  false,
        "mspp_savedeventkeyname":  null,
        "mspp_attachfiletypeerrormessage":  null,
        "_mspp_webform_value":  "a55b17a6-d4dc-f011-8406-002248e10de6",
        "mspp_movepreviouspermitted":  true,
        "mspp_tooltipenabled":  false,
        "mspp_redirecturl":  null,
        "_mspp_redirectwebpage_value":  null,
        "mspp_previousbuttoncssclass":  null,
        "mspp_geolocation_maptype":  756150000,
        "mspp_createautonumber":  false,
        "mspp_attachfilesizeerrormessage":  null,
        "mspp_provisionedlanguages":  null,
        "mspp_geolocation_countyfieldname":  null,
        "mspp_userhostaddressattributelogicalname":  null,
        "mspp_instructions":  null,
        "mspp_submitbuttoncssclass":  null,
        "mspp_primarykeyquerystringparametername":  "id",
        "mspp_validationsummarylinksenabled":  true,
        "_mspp_conditiondefaultnextstep_value":  null,
        "mspp_storageaccountname":  null,
        "mspp_geolocation_neighborhoodfieldname":  null,
        "mspp_type":  100000001,
        "mspp_entitysourcetype":  100000001,
        "mspp_validationsummarycssclass":  null,
        "mspp_modifiedon":  "2025-12-19T12:18:45Z",
        "mspp_referenceentityshowreadonlyform":  false,
        "mspp_attachfilemaxsize":  null,
        "mspp_mode":  100000001,
        "mspp_autonumberdefinitionname":  null,
        "mspp_geolocation_addresslinefieldname":  null,
        "mspp_validationgroup":  null,
        "mspp_geolocation_latitudefieldname":  null,
        "mspp_allowmultiplefiles":  false,
        "mspp_primarykeyattributelogicalname":  "msdyn_appointmentrequestid",
        "mspp_postbackurl":  null,
        "_mspp_createdby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_portaluserlookupattributeisactivityparty":  false,
        "mspp_geolocation_statefieldname":  null,
        "mspp_redirecturlquerystringname":  null,
        "mspp_name":  "Review",
        "mspp_populatereferenceentitylookupfield":  false
    },
    {
        "mspp_attachfilerequirederrormessage":  null,
        "mspp_tabname":  null,
        "mspp_appendquerystring":  false,
        "mspp_forceallfieldsrequired":  false,
        "mspp_referencetargetlookupattributelogicalname":  null,
        "mspp_targetentitylogicalname":  "msdyn_appointmentrequest",
        "mspp_loguser":  false,
        "mspp_referencesourceentitylogicalname":  null,
        "mspp_nextbuttontext":  null,
        "mspp_renderwebresourcesinline":  false,
        "mspp_useridentitynameattributelogicalname":  null,
        "mspp_webformstepid":  "a70410ac-d4dc-f011-8406-002248e10de6",
        "_mspp_modifiedby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_autogeneratesteps":  false,
        "mspp_createdon":  "2025-12-19T12:17:24Z",
        "mspp_editexpiredstatecode":  null,
        "mspp_submiteventkeyname":  null,
        "mspp_redirecturlcustomquerystring":  null,
        "mspp_nextbuttoncssclass":  null,
        "mspp_accept":  null,
        "mspp_movepreviouseventkeyname":  null,
        "mspp_captcharequired":  false,
        "mspp_referenceentityreadonlyformname":  "",
        "mspp_formname":  "Appointment Confirmation",
        "mspp_validationsummaryheadertext":  null,
        "mspp_referenceentitysourcetype":  100000001,
        "mspp_referencerecordsourcerelationshipname":  null,
        "mspp_savingeventkeyname":  null,
        "mspp_condition":  null,
        "_mspp_referenceentitystep_value":  null,
        "mspp_autonumberattributelogicalname":  null,
        "mspp_settings":  null,
        "mspp_usercontrolpath":  null,
        "mspp_previousbuttontext":  null,
        "mspp_editexpiredstatusreason":  null,
        "mspp_hideformonsuccess":  true,
        "mspp_showunsupportedfields":  false,
        "mspp_attachfilerequired":  false,
        "mspp_entitypermissionsenabled":  true,
        "mspp_showownerfields":  false,
        "mspp_attachfilelabel":  null,
        "mspp_usercontroltitle":  "",
        "mspp_targetentityprimarykeylogicalname":  null,
        "mspp_attachfilestoragelocation":  null,
        "mspp_submitbuttontext":  null,
        "mspp_recordnotfoundmessage":  null,
        "mspp_redirecturlappendentityidquerystring":  false,
        "mspp_containername":  null,
        "statecode":  0,
        "mspp_redirecturlquerystringattributeparamname":  null,
        "mspp_geolocation_longitudefieldname":  null,
        "mspp_attachfile":  false,
        "mspp_geolocation_displaymap":  false,
        "mspp_setentityreference":  false,
        "mspp_referencequerystringname":  null,
        "mspp_geolocation_cityfieldname":  null,
        "mspp_editnotpermittedmessage":  null,
        "mspp_editexpiredmessage":  null,
        "mspp_showcaptchaforauthenticatedusers":  false,
        "mspp_loadeventkeyname":  null,
        "mspp_recommendedfieldsrequired":  false,
        "mspp_geolocation_countryfieldname":  null,
        "mspp_registerstartupscript":  "$(function() {\r\n    $(\u0027[data-name=\"info-lookup\"]\u0027).parent().hide();\r\n    $(\"#PreviousButton\").hide();\r\n    $(\".progress.list-group\").hide();\r\n    $(\".actions\").hide();\r\n\r\n    const appointmentType = $(\"#msdyn_bankappointmenttype option:selected\").text()\r\n    const timeSlot = $(\"#msdynce_selectedtimeslot\").val();\r\n    const descriptionValue = $(\"#msdynce_description\").val();\r\n    let scheduledstart = $(\"#msdynce_scheduledstart_datepicker_description\").val(), \r\n        scheduledend = $(\"#msdynce_scheduledend_datepicker_description\").val(), \r\n        address, \r\n        email = $(\"#msdynce_emailaddress\").val();\r\n\r\n    (function (webapi, $) {\r\n        function safeAjax(ajaxOptions) {\r\n            var deferredAjax = $.Deferred();\r\n            shell.getTokenDeferred().done(function (token) {\r\n                if (!ajaxOptions.headers) {\r\n                    $.extend(ajaxOptions, {\r\n                        headers: {\r\n                            \"__RequestVerificationToken\": token\r\n                        }\r\n                    });\r\n                } else {\r\n                    ajaxOptions.headers[\"__RequestVerificationToken\"] = token;\r\n                }\r\n                $.ajax(ajaxOptions)\r\n                    .done(function (data, textStatus, jqXHR) {\r\n                        validateLoginSession(data, textStatus, jqXHR, deferredAjax.resolve);\r\n                    }).fail(deferredAjax.reject); //ajax\r\n            }).fail(function () {\r\n                deferredAjax.rejectWith(this, arguments); // On token failure pass the token ajax and args\r\n            });\r\n            return deferredAjax.promise();\r\n        }\r\n        webapi.safeAjax = safeAjax;\r\n    })(window.webapi = window.webapi || {}, jQuery)\r\n\r\n    function appAjax(processingMsg, ajaxOptions) {\r\n        return webapi.safeAjax(ajaxOptions)\r\n        .fail(function (response) {\r\n            if (response.responseJSON) {\r\n                alert(\"Error: \" + response.responseJSON.error.message)\r\n            } else {\r\n                alert(\"Error: Web API is not available... \")\r\n            }\r\n        });\r\n    }\r\n\r\n    function fetchService() {\r\n        const serviceId = $(\"#msdyn_services\").val();\r\n        return appAjax(\u0027Loading...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/msdyn_services(${serviceId})?$select=msdynce_servicesubcategory,msdyn_servicecategory`,\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    fetchService().done(function (data) {\r\n        $(\"#service-category\").text(data[\u0027msdyn_servicecategory@OData.Community.Display.V1.FormattedValue\u0027]);\r\n        $(\"#service-sub-category\").text(data[\u0027msdynce_servicesubcategory@OData.Community.Display.V1.FormattedValue\u0027]);\r\n    });\r\n\r\n    function fetchBranch() {\r\n        const branchId = $(\"#msdyn_location\").val();\r\n        return appAjax(\u0027Loading...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/msdyn_locations(${branchId})?$select=msdyn_name,msdyn_branchaddress,msdyn_latitude,msdyn_longitude`,\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    fetchBranch().done(function (data) {\r\n        if($(\"#msdyn_bankappointmenttype option:selected\").val() == 192350000) {\r\n            $(\"#bank-name\").text(data.msdyn_name);\r\n            $(\"#bank-address\").text(data.msdyn_branchaddress);\r\n        } else if($(\"#msdyn_bankappointmenttype option:selected\").val() == 192350001) {\r\n            $(\"#bank-name\").text(\u0027Conference software\u0027);\r\n            $(\"#bank-address\").html(\u0027\u003ca href=\"http://www.bankname.com/virtualmeeting/\" target=\"_blank\"\u003ehttp://www.bankname.com/virtualmeeting/\u003c/a\u003e\u0027);\r\n        }\r\n        address = data.msdyn_branchaddress;\r\n        $(\"#bing-map-link\").attr(\"href\", `https://www.bing.com/maps?rtp=adr.?current location~pos.${data.msdyn_latitude}_${data.msdyn_longitude}`)\r\n    });\r\n\r\n    function fetchBranchRep() {\r\n        const branchRepId = $(\"#msdyn_bankrepcontact\").val();\r\n        return appAjax(\u0027Fetching branch rep details...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/contacts(${branchRepId})?$select=fullname,mobilephone`,\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    fetchBranchRep().done(function (data) {\r\n        $(\"#rep-name\").text(data.fullname);\r\n        $(\"#rep-phone\").text(data.mobilephone);\r\n    });\r\n\r\n    const reviewDetails = `\r\n    \u003ctd colspan=\"1\" rowspan=\"1\" class=\"clearfix cell\"\u003e\r\n        \u003cfieldset class=\"review-step-two\" style=\"font-size: 18px; line-height: 25px; color: rgb(69, 69, 69);\"\u003e\r\n            \u003cdiv class=\"review-header\" style=\"text-align: center;\"\u003e\u003cimg src=\"/Icon_Successful_Appoinment\"\r\n                    style=\"margin-bottom: 20px; width: 85px;\"\u003e\r\n                \u003clegend class=\"section-title\"\u003eThanks \u003cspan\u003e\u003c/span\u003e! We look forward to seeing you.\u003c/legend\u003e\r\n            \u003c/div\u003e\r\n            \u003cdiv class=\"review-form\"\u003e\r\n                \u003cdiv class=\"documentSection\"\u003e\r\n                    \u003clegend class=\"section-header-label\"\u003e\r\n                        What you’ll need to bring\u003c/legend\u003e\r\n                    \u003cdiv\u003e[This is a sample text] Remember to bring 2 forms of ID and and relevant documents\u003c/div\u003e\r\n                    \u003cdiv class=\"primaryform\"\u003ePrimary forms of ID include:\u003cul\u003e\r\n                            \u003cli\u003eDriver’s license\u003c/li\u003e\r\n                            \u003cli\u003eState ID\u003c/li\u003e\r\n                            \u003cli\u003eU.S. Passport\u003c/li\u003e\r\n                        \u003c/ul\u003e\r\n                    \u003c/div\u003e\r\n                    \u003cdiv class=\"secondaryform\"\u003eSecondary forms of ID include:\u003cul\u003e\r\n                            \u003cli\u003eCredit or debit card\u003c/li\u003e\r\n                            \u003cli\u003eBank statement\u003c/li\u003e\r\n                            \u003cli\u003eRecent pay stub or utility bill in your name\u003c/li\u003e\r\n                        \u003c/ul\u003e\r\n                    \u003c/div\u003e\r\n                \u003c/div\u003e\r\n                \u003cdiv class=\"appointmentSection\"\u003e\r\n                    \u003clegend class=\"section-header-label\"\u003e Appointment details\u003c/legend\u003e\r\n                    \u003cdiv class=\"aptmnt-card\"\u003e\u003cspan class=\"apt-title\"\u003eWhy?\u003c/span\u003e\r\n                        \u003cdiv class=\"apt-details\"\u003e\r\n                            \u003cul\u003e\r\n                                \u003cli id=\"service-category\"\u003e\u003c/li\u003e\r\n                                \u003cli id=\"service-sub-category\"\u003e\u003c/li\u003e\r\n                            \u003c/ul\u003e\r\n                        \u003c/div\u003e\r\n                    \u003c/div\u003e\r\n                    \u003cdiv class=\"aptmnt-card\"\u003e\u003cspan class=\"apt-title\"\u003eHow?\u003c/span\u003e\r\n                        \u003cdiv class=\"apt-details\"\u003e\r\n                            \u003cul\u003e\r\n                                \u003cli id=\"appointment-type\"\u003e${appointmentType}\u003c/li\u003e\r\n                                \u003cli id=\"bank-name\"\u003e\u003c/li\u003e\r\n                                \u003cli id=\"bank-address\"\u003e\u003c/li\u003e\r\n                            \u003c/ul\u003e\r\n                        \u003c/div\u003e\r\n                        \u003cdiv class=\"direction-details\"\u003e\u003ca\r\n                                id=\"bing-map-link\"\r\n                                target=\"_blank\"\u003e\u003cimg src=\"/Icon_Get_Direction\"\u003e\u003cspan\u003eGet directions\u003c/span\u003e\u003c/a\u003e\u003c/div\u003e\r\n                    \u003c/div\u003e\r\n                    \u003cdiv class=\"aptmnt-card\"\u003e\u003cspan class=\"apt-title\"\u003eYou are meeting with\u003c/span\u003e\r\n                        \u003cdiv class=\"apt-details\"\u003e\r\n                            \u003cul\u003e\r\n                                \u003cli id=\"rep-name\"\u003e\u003c/li\u003e\r\n                                \u003cli id=\"rep-phone\"\u003e\u003c/li\u003e\r\n                            \u003c/ul\u003e\r\n                        \u003c/div\u003e\r\n                    \u003c/div\u003e\r\n                    \u003cdiv class=\"aptmnt-card\"\u003e\u003cspan class=\"apt-title\"\u003eWhen?\u003c/span\u003e\r\n                        \u003cdiv class=\"apt-details\"\u003e\r\n                            \u003cul\u003e\r\n                                \u003cli\u003e${timeSlot}\u003c/li\u003e\r\n                                \u003cli\u003e(60 minutes)\u003c/li\u003e\r\n                            \u003c/ul\u003e\r\n                        \u003c/div\u003e\r\n                        \u003cdiv id=\"generate-calendar-invite\" class=\"calendar-details\"\u003e\u003ca href=\"#\"\u003e\u003cimg\r\n                            src=\"/Icon_Add_To_Calendar\"\u003e\u003cspan\u003eAdd to calendar\u003c/span\u003e\u003c/a\u003e\u003c/div\u003e\r\n                    \u003c/div\u003e\r\n                \u003c/div\u003e\r\n                \u003cdiv class=\"otherSection\"\u003e\r\n                    \u003clegend class=\"section-header-label\"\u003e\r\n                        Is there anything else you would like us to know?\u003c/legend\u003e\r\n                    \u003cdiv id=\"appointment-description\"\u003e${descriptionValue}\u003c/div\u003e\r\n                \u003c/div\u003e\r\n                \u003cdiv style=\"margin-top: 65px;\"\u003e\r\n                    \u003cinput type=\"button\" class=\"button1\" id=\"another-app\" value=\"Book another appointment\"\r\n                        style=\"width: 353px;\"\u003e\r\n                    \u003cinput type=\"button\" class=\"button1\" id=\"reschedule-app\" value=\"Reschedule\"\r\n                        style=\"width: 200px; float: right;\"\u003e\r\n                \u003c/div\u003e\r\n            \u003c/div\u003e\r\n        \u003c/fieldset\u003e\r\n    \u003c/td\u003e`;\r\n\r\n    $(\u0027table[data-name=\"main-section\"] tbody\u0027).find(\u0027tr\u0027).first().append(reviewDetails.text());\r\n\r\n    $(\"#another-app\").click(function() { window.location = window.location.pathname });  \r\n    $(\"#reschedule-app\").click(function() { window.location = window.location.origin + \"/reschedule-appointment/?id=\" + $(\"#EntityFormView_EntityID\").val() });\r\n\r\n    $(\"#generate-calendar-invite\").click(function() {\r\n        msgData1 = moment(new Date(scheduledstart + \" UTC\")).format(\u0027MMM DD, YYYY | hh:mm A\u0027);\r\n        msgData2 = moment(new Date(scheduledend + \" UTC\")).format(\u0027MMM DD, YYYY | hh:mm A\u0027);\r\n        msgData3 = address;\r\n        email = email;\r\n        const icsMSG = \"BEGIN:VCALENDAR\\nVERSION:2.0\\nPRODID:-//Our Company//NONSGML v1.0//EN\\nBEGIN:VEVENT\\nUID:me@google.com\\nDTSTAMP:yyyymmddThhmmssZ\\nATTENDEE;CN=Organizer;RSVP=TRUE:MAILTO:\u0027\" + email + \"\u0027\\nORGANIZER;CN=:MAILTO::\u0027\" + email + \"\u0027\\nDTSTART:\" + msgData1 + \"\\nDTEND:\" + msgData2 + \"\\nLOCATION:\" + msgData3 + \"\\nSUMMARY:Appointment\\nEND:VEVENT\\nEND:VCALENDAR\";\r\n        window.open(\"data:text/calendar;charset=utf8,\" + escape(icsMSG));\r\n    });\r\n})",
        "statuscode":  1,
        "mspp_attachfilerestrictaccept":  false,
        "mspp_validationsummarylinktext":  null,
        "_mspp_nextstep_value":  null,
        "mspp_associatecurrentportaluser":  false,
        "mspp_redirecturlquerystringattribute":  null,
        "mspp_referenceentityprimarykeylogicalname":  null,
        "_mspp_entitysourcestep_value":  null,
        "mspp_referenceentityrelationshipname":  null,
        "mspp_targetentityportaluserlookupattribute":  null,
        "_mspp_previousstep_value":  null,
        "mspp_title":  null,
        "mspp_multiplerecordsperuserpermitted":  false,
        "mspp_referenceentitylogicalname":  null,
        "mspp_maximumnooffiles":  null,
        "mspp_geolocation_formattedaddressfieldname":  null,
        "mspp_successmessage":  null,
        "mspp_editexistingrecordpermitted":  false,
        "mspp_geolocation_postalcodefieldname":  null,
        "mspp_submitbuttonbusytext":  null,
        "mspp_referencequeryattributelogicalname":  null,
        "mspp_recordsourcerelationshipname":  null,
        "mspp_referencequerystringisprimarykey":  true,
        "mspp_geolocation_enabled":  false,
        "mspp_savedeventkeyname":  null,
        "mspp_attachfiletypeerrormessage":  null,
        "_mspp_webform_value":  "a55b17a6-d4dc-f011-8406-002248e10de6",
        "mspp_movepreviouspermitted":  true,
        "mspp_tooltipenabled":  false,
        "mspp_redirecturl":  null,
        "_mspp_redirectwebpage_value":  null,
        "mspp_previousbuttoncssclass":  null,
        "mspp_geolocation_maptype":  756150000,
        "mspp_createautonumber":  false,
        "mspp_attachfilesizeerrormessage":  null,
        "mspp_provisionedlanguages":  null,
        "mspp_geolocation_countyfieldname":  null,
        "mspp_userhostaddressattributelogicalname":  null,
        "mspp_instructions":  null,
        "mspp_submitbuttoncssclass":  null,
        "mspp_primarykeyquerystringparametername":  "id",
        "mspp_validationsummarylinksenabled":  true,
        "_mspp_conditiondefaultnextstep_value":  null,
        "mspp_storageaccountname":  null,
        "mspp_geolocation_neighborhoodfieldname":  null,
        "mspp_type":  100000001,
        "mspp_entitysourcetype":  100000001,
        "mspp_validationsummarycssclass":  null,
        "mspp_modifiedon":  "2025-12-19T12:18:52Z",
        "mspp_referenceentityshowreadonlyform":  false,
        "mspp_attachfilemaxsize":  null,
        "mspp_mode":  100000001,
        "mspp_autonumberdefinitionname":  null,
        "mspp_geolocation_addresslinefieldname":  null,
        "mspp_validationgroup":  null,
        "mspp_geolocation_latitudefieldname":  null,
        "mspp_allowmultiplefiles":  false,
        "mspp_primarykeyattributelogicalname":  "msdyn_appointmentrequestid",
        "mspp_postbackurl":  null,
        "_mspp_createdby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_portaluserlookupattributeisactivityparty":  false,
        "mspp_geolocation_statefieldname":  null,
        "mspp_redirecturlquerystringname":  null,
        "mspp_name":  "Appointment Confirmation",
        "mspp_populatereferenceentitylookupfield":  false
    },
    {
        "mspp_attachfilerequirederrormessage":  null,
        "mspp_tabname":  null,
        "mspp_appendquerystring":  false,
        "mspp_forceallfieldsrequired":  false,
        "mspp_referencetargetlookupattributelogicalname":  null,
        "mspp_targetentitylogicalname":  "msdyn_appointmentrequest",
        "mspp_loguser":  false,
        "mspp_referencesourceentitylogicalname":  null,
        "mspp_nextbuttontext":  null,
        "mspp_renderwebresourcesinline":  false,
        "mspp_useridentitynameattributelogicalname":  null,
        "mspp_webformstepid":  "110510ac-d4dc-f011-8406-002248e10de6",
        "_mspp_modifiedby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_autogeneratesteps":  false,
        "mspp_createdon":  "2025-12-19T12:17:28Z",
        "mspp_editexpiredstatecode":  null,
        "mspp_submiteventkeyname":  null,
        "mspp_redirecturlcustomquerystring":  null,
        "mspp_nextbuttoncssclass":  "btn button1",
        "mspp_accept":  null,
        "mspp_movepreviouseventkeyname":  null,
        "mspp_captcharequired":  false,
        "mspp_referenceentityreadonlyformname":  "",
        "mspp_formname":  "Create an Appointment Step 6",
        "mspp_validationsummaryheadertext":  null,
        "mspp_referenceentitysourcetype":  100000001,
        "mspp_referencerecordsourcerelationshipname":  null,
        "mspp_savingeventkeyname":  null,
        "mspp_condition":  null,
        "_mspp_referenceentitystep_value":  null,
        "mspp_autonumberattributelogicalname":  null,
        "mspp_settings":  null,
        "mspp_usercontrolpath":  null,
        "mspp_previousbuttontext":  null,
        "mspp_editexpiredstatusreason":  null,
        "mspp_hideformonsuccess":  true,
        "mspp_showunsupportedfields":  false,
        "mspp_attachfilerequired":  false,
        "mspp_entitypermissionsenabled":  true,
        "mspp_showownerfields":  false,
        "mspp_attachfilelabel":  null,
        "mspp_usercontroltitle":  "",
        "mspp_targetentityprimarykeylogicalname":  null,
        "mspp_attachfilestoragelocation":  null,
        "mspp_submitbuttontext":  null,
        "mspp_recordnotfoundmessage":  null,
        "mspp_redirecturlappendentityidquerystring":  false,
        "mspp_containername":  null,
        "statecode":  0,
        "mspp_redirecturlquerystringattributeparamname":  null,
        "mspp_geolocation_longitudefieldname":  null,
        "mspp_attachfile":  false,
        "mspp_geolocation_displaymap":  false,
        "mspp_setentityreference":  false,
        "mspp_referencequerystringname":  null,
        "mspp_geolocation_cityfieldname":  null,
        "mspp_editnotpermittedmessage":  null,
        "mspp_editexpiredmessage":  null,
        "mspp_showcaptchaforauthenticatedusers":  false,
        "mspp_loadeventkeyname":  null,
        "mspp_recommendedfieldsrequired":  false,
        "mspp_geolocation_countryfieldname":  null,
        "mspp_registerstartupscript":  "$(function() {\r\n    $(\u0027[data-name=\"info-lookup\"]\u0027).parent().hide();\r\n\r\n    const nextButtonContainer = $(\"#NextButton\").closest(\".entity-action-button\");\r\n    nextButtonContainer.after(\u0027\u003cdiv role=\"group\" class=\"btn-group entity-action-button\"\u003e\u003cinput type=\"button\" value=\"Submit\" id=\"SubmitButton\" class=\"btn btn-primary button next submit-btn\"\u003e\u003c/div\u003e\u0027);\r\n    $(\"#NextButton\").hide();\r\n\r\n    const descriptionElement = $(\"#msdynce_description\");\r\n\r\n    const dataObject = {};\r\n\r\n    dataObject[\"msdynce_firstname\"] = $(\"#msdynce_firstname\").val();\r\n    dataObject[\"msdynce_lastname\"] = $(\"#msdynce_lastname\").val();\r\n    dataObject[\"msdynce_emailaddress\"] = $(\"#msdynce_emailaddress\").val();\r\n    dataObject[\"msdynce_statuscancel\"] = 441790002;\r\n    dataObject[\"scheduledstart\"] = $(\"#msdynce_scheduledstart\").val();\r\n    dataObject[\"scheduledend\"] = $(\"#msdynce_scheduledend\").val();\r\n\r\n    const appointmentType = $(\"#msdyn_bankappointmenttype option:selected\").text()\r\n    dataObject[\"msdyn_bankappointmenttype\"] = $(\"#msdyn_bankappointmenttype option:selected\").val()\r\n    const timeSlot = $(\"#msdynce_selectedtimeslot\").val();\r\n    dataObject[\"msdynce_selectedtimeslot\"] = $(\"#msdynce_selectedtimeslot\").val();\r\n    \r\n    const branchRepId = $(\"#msdyn_bankrepcontact\").val();\r\n    if(branchRepId) {\r\n        dataObject[\"msdynce_contact_Appointment@odata.bind\"] = \"/contacts(\" + branchRepId + \")\";\r\n    }\r\n\r\n    (function (webapi, $) {\r\n        function safeAjax(ajaxOptions) {\r\n            var deferredAjax = $.Deferred();\r\n            shell.getTokenDeferred().done(function (token) {\r\n                // Add headers for ajax\r\n                if (!ajaxOptions.headers) {\r\n                    $.extend(ajaxOptions, {\r\n                        headers: {\r\n                            \"__RequestVerificationToken\": token\r\n                        }\r\n                    });\r\n                } else {\r\n                    ajaxOptions.headers[\"__RequestVerificationToken\"] = token;\r\n                }\r\n                $.ajax(ajaxOptions)\r\n                    .done(function (data, textStatus, jqXHR) {\r\n                        validateLoginSession(data, textStatus, jqXHR, deferredAjax.resolve);\r\n                    }).fail(deferredAjax.reject); //ajax\r\n            }).fail(function () {\r\n                deferredAjax.rejectWith(this, arguments); // On token failure pass the token ajax and args\r\n            });\r\n            return deferredAjax.promise();\r\n        }\r\n        webapi.safeAjax = safeAjax;\r\n    })(window.webapi = window.webapi || {}, jQuery)\r\n\r\n    function appAjax(processingMsg, ajaxOptions) {\r\n        return webapi.safeAjax(ajaxOptions)\r\n        .fail(function (response) {\r\n            if (response.responseJSON) {\r\n                alert(\"Error: \" + response.responseJSON.error.message)\r\n            } else {\r\n                alert(\"Error: Web API is not available... \")\r\n            }\r\n        });\r\n    }\r\n\r\n    function fetchService() {\r\n        const serviceId = $(\"#msdyn_services\").val();\r\n        dataObject[\"msdynce_Services_Appointment@odata.bind\"] = \"/msdyn_services(\" + serviceId + \")\";\r\n        return appAjax(\u0027Loading...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/msdyn_services(${serviceId})?$select=msdyn_name,msdyn_servicecategory`,\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    fetchService().done(function (data) {\r\n        $(\"#service-category\").text(data[\u0027msdyn_servicecategory@OData.Community.Display.V1.FormattedValue\u0027]);\r\n        $(\"#service-sub-category\").text(data[\u0027msdyn_name\u0027]);\r\n    });\r\n\r\n    function fetchBranch() {\r\n        const branchId = $(\"#msdyn_location\").val();\r\n        dataObject[\"msdyn_Location_Appointment@odata.bind\"] = \"/msdyn_locations(\" + branchId + \")\";\r\n        return appAjax(\u0027Loading...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/msdyn_locations(${branchId})?$select=msdyn_name,msdyn_branchaddress`,\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    fetchBranch().done(function (data) {\r\n        if($(\"#msdyn_bankappointmenttype option:selected\").val() == 192350000) {\r\n            $(\"#bank-name\").text(data.msdyn_name);\r\n            $(\"#bank-address\").text(data.msdyn_branchaddress);\r\n        } else if($(\"#msdyn_bankappointmenttype option:selected\").val() == 192350001) {\r\n            $(\"#bank-name\").text(\u0027Conference software\u0027);\r\n            $(\"#bank-address\").html(\u0027\u003ca href=\"http://www.bankname.com/virtualmeeting/\" target=\"_blank\"\u003ehttp://www.bankname.com/virtualmeeting/\u003c/a\u003e\u0027);\r\n        }\r\n    });\r\n\r\n    function fetchBranchRep() {\r\n        return appAjax(\u0027Fetching branch rep details...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/contacts(${branchRepId})?$select=fullname,mobilephone`,\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    fetchBranchRep().done(function (data) {\r\n        $(\"#rep-name\").text(data.fullname);\r\n        $(\"#rep-phone\").text(data.mobilephone);\r\n    });\r\n\r\n    $(document).on(\u0027keyup\u0027, \u0027#description_text\u0027, function () {\r\n        $(\"#letterCountRow\").show();\r\n        const descriptionValue = $(this).val();\r\n        $(\"#letterCount\").text(descriptionValue.length);\r\n        descriptionElement.val(descriptionValue);\r\n        LengthError(\u0027#description_text\u0027);\r\n    });\r\n\r\n    const reviewDetails = `\r\n    \u003ctd colspan=\"1\" rowspan=\"1\" class=\"clearfix cell\"\u003e\r\n        \u003cdiv class=\"tab-title\"\u003e\r\n            Appointment details\r\n        \u003c/div\u003e\r\n        \u003cdiv class=\"review-card\"\u003e\u003cspan class=\"apt-title\"\u003eWhy?\u003c/span\u003e\r\n            \u003cdiv class=\"apt-details\"\u003e\r\n            \u003cul\u003e\r\n                \u003cli id=\"service-category\"\u003e\u003c/li\u003e\r\n                \u003cli id=\"service-sub-category\"\u003e\u003c/li\u003e\r\n            \u003c/ul\u003e\r\n            \u003c/div\u003e\r\n        \u003c/div\u003e\r\n        \u003cdiv class=\"review-card\"\u003e\u003cspan class=\"apt-title\"\u003eHow?\u003c/span\u003e\r\n            \u003cdiv class=\"apt-details\"\u003e\r\n            \u003cul\u003e\r\n                \u003cli\u003e${appointmentType}\u003c/li\u003e\r\n                \u003cli id=\"bank-name\"\u003e\u003c/li\u003e\r\n                \u003cli id=\"bank-address\"\u003e\u003c/li\u003e\r\n            \u003c/ul\u003e\r\n            \u003c/div\u003e\r\n        \u003c/div\u003e\r\n        \u003cdiv class=\"review-card\"\u003e\u003cspan class=\"apt-title\"\u003eYou are meeting with\u003c/span\u003e\r\n            \u003cdiv class=\"apt-details\"\u003e\r\n            \u003cul\u003e\r\n                \u003cli id=\"rep-name\"\u003e\u003c/li\u003e\r\n                \u003cli id=\"rep-phone\"\u003e\u003c/li\u003e\r\n            \u003c/ul\u003e\r\n            \u003c/div\u003e\r\n            \u003cdiv class=\"edit-details\" style=\"display:none\"\u003eEdit\u003cimg src=\"/Icon_Edit_Pencil\"\u003e\u003c/div\u003e\r\n        \u003c/div\u003e\r\n        \u003cdiv class=\"review-card\"\u003e\u003cspan class=\"apt-title\"\u003eWhen?\u003c/span\u003e\r\n            \u003cdiv class=\"apt-details\"\u003e\r\n            \u003cul\u003e\r\n                \u003cli\u003e${timeSlot}\u003c/li\u003e\r\n                \u003cli\u003e(60 minutes)\u003c/li\u003e\r\n            \u003c/ul\u003e\r\n            \u003c/div\u003e\r\n            \u003cdiv class=\"edit-details\" style=\"display:none\"\u003eEdit\u003cimg src=\"/Icon_Edit_Pencil\"\u003e\u003c/div\u003e\r\n        \u003c/div\u003e\r\n        \u003cdiv class=\"custom-textarea clearfix\"\u003e\r\n            \u003cp\u003eIs there anything else you would like us to know?\u003c/p\u003e\r\n            \u003ctextarea maxlength=\"1000\" class=\"form-control customBox\" id=\"description_text\" style=\"resize: none;\"\r\n            placeholder=\"[This is a sample text] Let us know if there is something else you would like us to prepare for your appointment.\"\u003e\r\n            \u003c/textarea\u003e\r\n            \u003cspan id=\"letterCountRow\"\u003e\u003cspan id=\"letterCount\"\u003e\u003c/span\u003e/1,000\u003c/span\u003e\r\n        \u003c/div\u003e\r\n    \u003c/td\u003e`;\r\n\r\n    $(\u0027[data-name=\"main-section\"] tbody\u0027).find(\u0027tr\u0027).first().append(reviewDetails.text());\r\n    $(\u0027#description_text\u0027).val(descriptionElement.val());\r\n\r\n    $(\"#SubmitButton\").click(function() {\r\n        dataObject[\"description\"] = $(\"#msdynce_description\").val();\r\n        dataObject[\"msdyn_AppointmentRequest_Appointment@odata.bind\"] = \"/msdyn_appointmentrequests(\" + $(\"#EntityFormView_EntityID\").val() + \")\";\r\n        const speciality = $(\"#service-sub-category\").text();\r\n        const repName = $(\"#rep-name\").text();\r\n        dataObject[\"subject\"] = `Chat about ${speciality} with ${repName}`;\r\n        appAjax(\u0027Loading...\u0027, {\r\n            type: \"POST\",\r\n            url: `/_api/appointments`,\r\n            contentType: \"application/json\",\r\n            data: JSON.stringify(dataObject),\r\n        }).done(function (res, status, xhr) {\r\n            $(\"#msdyn_appointment\").val(xhr.getResponseHeader(\"entityid\"));\r\n            $(\"#msdyn_appointment_entityname\").val(\"appointment\");\r\n            $(\"#msdyn_name\").val( dataObject[\"subject\"]);\r\n            $(\"#SubmitButton\").hide();\r\n            $(\"#NextButton\").show().click();\r\n        });\r\n    });\r\n    function LengthError(targetField, sourceEvent) {\r\n        var maxLength = parseInt($(targetField).attr(\u0027maxlength\u0027));\r\n        var errorMessageID = \u0027length_error_message\u0027;\r\n        if ($(\u0027#\u0027 + errorMessageID).length) {\r\n          $(\u0027#\u0027 + errorMessageID).remove();\r\n        }\r\n    \r\n        if ($(targetField).val().length == maxLength) {\r\n          $(targetField).after(\r\n            \u0027\u003cp class=\"alert sr-only\" role=\"alert\" id=\"\u0027 +\r\n              errorMessageID +\r\n              \u0027\"\u003e\u0027 +\r\n              window.ResourceManager[\u0027Length_ErrorText\u0027] +\r\n              \u0027\u003c/p\u003e\u0027\r\n          );\r\n          return false;\r\n        }\r\n        return true;\r\n    }\r\n});",
        "statuscode":  1,
        "mspp_attachfilerestrictaccept":  false,
        "mspp_validationsummarylinktext":  null,
        "_mspp_nextstep_value":  "7a0510ac-d4dc-f011-8406-002248e10de6",
        "mspp_associatecurrentportaluser":  false,
        "mspp_redirecturlquerystringattribute":  null,
        "mspp_referenceentityprimarykeylogicalname":  null,
        "_mspp_entitysourcestep_value":  "32ec11b2-d4dc-f011-8406-002248e10de6",
        "mspp_referenceentityrelationshipname":  null,
        "mspp_targetentityportaluserlookupattribute":  null,
        "_mspp_previousstep_value":  null,
        "mspp_title":  "[{\"LCID\":1033,\"Value\":\"\u003ch3\u003e6. Reseña\u003c/h3\u003e\"}]",
        "mspp_multiplerecordsperuserpermitted":  false,
        "mspp_referenceentitylogicalname":  null,
        "mspp_maximumnooffiles":  null,
        "mspp_geolocation_formattedaddressfieldname":  null,
        "mspp_successmessage":  null,
        "mspp_editexistingrecordpermitted":  false,
        "mspp_geolocation_postalcodefieldname":  null,
        "mspp_submitbuttonbusytext":  null,
        "mspp_referencequeryattributelogicalname":  null,
        "mspp_recordsourcerelationshipname":  null,
        "mspp_referencequerystringisprimarykey":  true,
        "mspp_geolocation_enabled":  false,
        "mspp_savedeventkeyname":  null,
        "mspp_attachfiletypeerrormessage":  null,
        "_mspp_webform_value":  "925a17a6-d4dc-f011-8406-002248e10de6",
        "mspp_movepreviouspermitted":  true,
        "mspp_tooltipenabled":  false,
        "mspp_redirecturl":  null,
        "_mspp_redirectwebpage_value":  null,
        "mspp_previousbuttoncssclass":  "btn button2",
        "mspp_geolocation_maptype":  756150000,
        "mspp_createautonumber":  false,
        "mspp_attachfilesizeerrormessage":  null,
        "mspp_provisionedlanguages":  null,
        "mspp_geolocation_countyfieldname":  null,
        "mspp_userhostaddressattributelogicalname":  null,
        "mspp_instructions":  null,
        "mspp_submitbuttoncssclass":  null,
        "mspp_primarykeyquerystringparametername":  null,
        "mspp_validationsummarylinksenabled":  true,
        "_mspp_conditiondefaultnextstep_value":  null,
        "mspp_storageaccountname":  null,
        "mspp_geolocation_neighborhoodfieldname":  null,
        "mspp_type":  100000001,
        "mspp_entitysourcetype":  100000003,
        "mspp_validationsummarycssclass":  null,
        "mspp_modifiedon":  "2025-12-19T12:18:47Z",
        "mspp_referenceentityshowreadonlyform":  false,
        "mspp_attachfilemaxsize":  null,
        "mspp_mode":  100000001,
        "mspp_autonumberdefinitionname":  null,
        "mspp_geolocation_addresslinefieldname":  null,
        "mspp_validationgroup":  null,
        "mspp_geolocation_latitudefieldname":  null,
        "mspp_allowmultiplefiles":  false,
        "mspp_primarykeyattributelogicalname":  null,
        "mspp_postbackurl":  null,
        "_mspp_createdby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_portaluserlookupattributeisactivityparty":  false,
        "mspp_geolocation_statefieldname":  null,
        "mspp_redirecturlquerystringname":  null,
        "mspp_name":  "6. Review",
        "mspp_populatereferenceentitylookupfield":  false
    },
    {
        "mspp_attachfilerequirederrormessage":  null,
        "mspp_tabname":  null,
        "mspp_appendquerystring":  false,
        "mspp_forceallfieldsrequired":  false,
        "mspp_referencetargetlookupattributelogicalname":  null,
        "mspp_targetentitylogicalname":  "msdyn_appointmentrequest",
        "mspp_loguser":  false,
        "mspp_referencesourceentitylogicalname":  null,
        "mspp_nextbuttontext":  null,
        "mspp_renderwebresourcesinline":  false,
        "mspp_useridentitynameattributelogicalname":  null,
        "mspp_webformstepid":  "7a0510ac-d4dc-f011-8406-002248e10de6",
        "_mspp_modifiedby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_autogeneratesteps":  false,
        "mspp_createdon":  "2025-12-19T12:17:33Z",
        "mspp_editexpiredstatecode":  null,
        "mspp_submiteventkeyname":  null,
        "mspp_redirecturlcustomquerystring":  null,
        "mspp_nextbuttoncssclass":  null,
        "mspp_accept":  null,
        "mspp_movepreviouseventkeyname":  null,
        "mspp_captcharequired":  false,
        "mspp_referenceentityreadonlyformname":  "",
        "mspp_formname":  "Appointment Confirmation",
        "mspp_validationsummaryheadertext":  null,
        "mspp_referenceentitysourcetype":  100000001,
        "mspp_referencerecordsourcerelationshipname":  null,
        "mspp_savingeventkeyname":  null,
        "mspp_condition":  null,
        "_mspp_referenceentitystep_value":  null,
        "mspp_autonumberattributelogicalname":  null,
        "mspp_settings":  null,
        "mspp_usercontrolpath":  null,
        "mspp_previousbuttontext":  null,
        "mspp_editexpiredstatusreason":  null,
        "mspp_hideformonsuccess":  true,
        "mspp_showunsupportedfields":  false,
        "mspp_attachfilerequired":  false,
        "mspp_entitypermissionsenabled":  true,
        "mspp_showownerfields":  false,
        "mspp_attachfilelabel":  null,
        "mspp_usercontroltitle":  "",
        "mspp_targetentityprimarykeylogicalname":  null,
        "mspp_attachfilestoragelocation":  null,
        "mspp_submitbuttontext":  null,
        "mspp_recordnotfoundmessage":  null,
        "mspp_redirecturlappendentityidquerystring":  false,
        "mspp_containername":  null,
        "statecode":  0,
        "mspp_redirecturlquerystringattributeparamname":  "id",
        "mspp_geolocation_longitudefieldname":  null,
        "mspp_attachfile":  false,
        "mspp_geolocation_displaymap":  false,
        "mspp_setentityreference":  false,
        "mspp_referencequerystringname":  null,
        "mspp_geolocation_cityfieldname":  null,
        "mspp_editnotpermittedmessage":  null,
        "mspp_editexpiredmessage":  null,
        "mspp_showcaptchaforauthenticatedusers":  false,
        "mspp_loadeventkeyname":  null,
        "mspp_recommendedfieldsrequired":  false,
        "mspp_geolocation_countryfieldname":  null,
        "mspp_registerstartupscript":  "$(function() {\r\n    $(\u0027[data-name=\"info-lookup\"]\u0027).parent().hide();\r\n    $(\"#PreviousButton\").hide();\r\n    $(\".progress.list-group\").hide();\r\n    $(\".actions\").hide();\r\n\r\n    const appointmentType = $(\"#msdyn_bankappointmenttype option:selected\").text()\r\n    const timeSlot = $(\"#msdynce_selectedtimeslot\").val();\r\n    const descriptionValue = $(\"#msdynce_description\").val();\r\n    let scheduledstart = $(\"#msdynce_scheduledstart_datepicker_description\").val(), \r\n        scheduledend = $(\"#msdynce_scheduledend_datepicker_description\").val(), \r\n        address, \r\n        email = $(\"#msdynce_emailaddress\").val();\r\n\r\n    (function (webapi, $) {\r\n        function safeAjax(ajaxOptions) {\r\n            var deferredAjax = $.Deferred();\r\n            shell.getTokenDeferred().done(function (token) {\r\n                if (!ajaxOptions.headers) {\r\n                    $.extend(ajaxOptions, {\r\n                        headers: {\r\n                            \"__RequestVerificationToken\": token\r\n                        }\r\n                    });\r\n                } else {\r\n                    ajaxOptions.headers[\"__RequestVerificationToken\"] = token;\r\n                }\r\n                $.ajax(ajaxOptions)\r\n                    .done(function (data, textStatus, jqXHR) {\r\n                        validateLoginSession(data, textStatus, jqXHR, deferredAjax.resolve);\r\n                    }).fail(deferredAjax.reject); //ajax\r\n            }).fail(function () {\r\n                deferredAjax.rejectWith(this, arguments); // On token failure pass the token ajax and args\r\n            });\r\n            return deferredAjax.promise();\r\n        }\r\n        webapi.safeAjax = safeAjax;\r\n    })(window.webapi = window.webapi || {}, jQuery)\r\n\r\n    function appAjax(processingMsg, ajaxOptions) {\r\n        return webapi.safeAjax(ajaxOptions)\r\n        .fail(function (response) {\r\n            if (response.responseJSON) {\r\n                alert(\"Error: \" + response.responseJSON.error.message)\r\n            } else {\r\n                alert(\"Error: Web API is not available... \")\r\n            }\r\n        });\r\n    }\r\n\r\n    function fetchService() {\r\n        const serviceId = $(\"#msdyn_services\").val();\r\n        return appAjax(\u0027Loading...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/msdyn_services(${serviceId})?$select=msdyn_name,msdyn_servicecategory`,\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    fetchService().done(function (data) {\r\n        $(\"#service-category\").text(data[\u0027msdyn_servicecategory@OData.Community.Display.V1.FormattedValue\u0027]);\r\n        $(\"#service-sub-category\").text(data[\u0027msdyn_name\u0027]);\r\n    });\r\n\r\n    function fetchBranch() {\r\n        const branchId = $(\"#msdyn_location\").val();\r\n        return appAjax(\u0027Loading...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/msdyn_locations(${branchId})?$select=msdyn_name,msdyn_branchaddress,msdyn_latitude,msdyn_longitude`,\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    fetchBranch().done(function (data) {\r\n        if($(\"#msdyn_bankappointmenttype option:selected\").val() == 192350000) {\r\n            $(\"#bank-name\").text(data.msdyn_name);\r\n            $(\"#bank-address\").text(data.msdyn_branchaddress);\r\n        } else if($(\"#msdyn_bankappointmenttype option:selected\").val() == 192350001) {\r\n            $(\"#bank-name\").text(\u0027Conference software\u0027);\r\n            $(\"#bank-address\").html(\u0027\u003ca href=\"http://www.bankname.com/virtualmeeting/\" target=\"_blank\"\u003ehttp://www.bankname.com/virtualmeeting/\u003c/a\u003e\u0027);\r\n        }\r\n        address = data.msdyn_branchaddress;\r\n        $(\"#bing-map-link\").attr(\"href\", `https://www.bing.com/maps?rtp=adr.?current location~pos.${data.msdyn_latitude}_${data.msdyn_longitude}`)\r\n    });\r\n\r\n    function fetchBranchRep() {\r\n        const branchRepId = $(\"#msdyn_bankrepcontact\").val();\r\n        return appAjax(\u0027Fetching branch rep details...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/contacts(${branchRepId})?$select=fullname,mobilephone`,\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    fetchBranchRep().done(function (data) {\r\n        $(\"#rep-name\").text(data.fullname);\r\n        $(\"#rep-phone\").text(data.mobilephone);\r\n    });\r\n\r\n    const reviewDetails = `\r\n    \u003ctd colspan=\"1\" rowspan=\"1\" class=\"clearfix cell\"\u003e\r\n        \u003cfieldset class=\"review-step-two\" style=\"font-size: 18px; line-height: 25px; color: rgb(69, 69, 69);\"\u003e\r\n            \u003cdiv class=\"review-header\" style=\"text-align: center;\"\u003e\u003cimg src=\"/Icon_Successful_Appoinment\"\r\n                    style=\"margin-bottom: 20px; width: 85px;\"\u003e\r\n                \u003clegend class=\"section-title\"\u003eThanks \u003cspan\u003e\u003c/span\u003e! We look forward to seeing you.\u003c/legend\u003e\r\n            \u003c/div\u003e\r\n            \u003cdiv class=\"review-form\"\u003e\r\n                \u003cdiv class=\"documentSection\"\u003e\r\n                    \u003clegend class=\"section-header-label\"\u003e\r\n                        What you’ll need to bring\u003c/legend\u003e\r\n                    \u003cdiv\u003e[This is a sample text] Remember to bring 2 forms of ID and and relevant documents\u003c/div\u003e\r\n                    \u003cdiv class=\"primaryform\"\u003ePrimary forms of ID include:\u003cul\u003e\r\n                            \u003cli\u003eDriver’s license\u003c/li\u003e\r\n                            \u003cli\u003eState ID\u003c/li\u003e\r\n                            \u003cli\u003eU.S. Passport\u003c/li\u003e\r\n                        \u003c/ul\u003e\r\n                    \u003c/div\u003e\r\n                    \u003cdiv class=\"secondaryform\"\u003eSecondary forms of ID include:\u003cul\u003e\r\n                            \u003cli\u003eCredit or debit card\u003c/li\u003e\r\n                            \u003cli\u003eBank statement\u003c/li\u003e\r\n                            \u003cli\u003eRecent pay stub or utility bill in your name\u003c/li\u003e\r\n                        \u003c/ul\u003e\r\n                    \u003c/div\u003e\r\n                \u003c/div\u003e\r\n                \u003cdiv class=\"appointmentSection\"\u003e\r\n                    \u003clegend class=\"section-header-label\"\u003e Appointment details\u003c/legend\u003e\r\n                    \u003cdiv class=\"aptmnt-card\"\u003e\u003cspan class=\"apt-title\"\u003eWhy?\u003c/span\u003e\r\n                        \u003cdiv class=\"apt-details\"\u003e\r\n                            \u003cul\u003e\r\n                                \u003cli id=\"service-category\"\u003e\u003c/li\u003e\r\n                                \u003cli id=\"service-sub-category\"\u003e\u003c/li\u003e\r\n                            \u003c/ul\u003e\r\n                        \u003c/div\u003e\r\n                    \u003c/div\u003e\r\n                    \u003cdiv class=\"aptmnt-card\"\u003e\u003cspan class=\"apt-title\"\u003eHow?\u003c/span\u003e\r\n                        \u003cdiv class=\"apt-details\"\u003e\r\n                            \u003cul\u003e\r\n                                \u003cli id=\"appointment-type\"\u003e${appointmentType}\u003c/li\u003e\r\n                                \u003cli id=\"bank-name\"\u003e\u003c/li\u003e\r\n                                \u003cli id=\"bank-address\"\u003e\u003c/li\u003e\r\n                            \u003c/ul\u003e\r\n                        \u003c/div\u003e\r\n                        \u003cdiv class=\"direction-details\"\u003e\u003ca\r\n                                id=\"bing-map-link\"\r\n                                target=\"_blank\"\u003e\u003cimg src=\"/Icon_Get_Direction\"\u003e\u003cspan\u003eGet directions\u003c/span\u003e\u003c/a\u003e\u003c/div\u003e\r\n                    \u003c/div\u003e\r\n                    \u003cdiv class=\"aptmnt-card\"\u003e\u003cspan class=\"apt-title\"\u003eYou are meeting with\u003c/span\u003e\r\n                        \u003cdiv class=\"apt-details\"\u003e\r\n                            \u003cul\u003e\r\n                                \u003cli id=\"rep-name\"\u003e\u003c/li\u003e\r\n                                \u003cli id=\"rep-phone\"\u003e\u003c/li\u003e\r\n                            \u003c/ul\u003e\r\n                        \u003c/div\u003e\r\n                    \u003c/div\u003e\r\n                    \u003cdiv class=\"aptmnt-card\"\u003e\u003cspan class=\"apt-title\"\u003eWhen?\u003c/span\u003e\r\n                        \u003cdiv class=\"apt-details\"\u003e\r\n                            \u003cul\u003e\r\n                                \u003cli\u003e${timeSlot}\u003c/li\u003e\r\n                                \u003cli\u003e(60 minutes)\u003c/li\u003e\r\n                            \u003c/ul\u003e\r\n                        \u003c/div\u003e\r\n                        \u003cdiv id=\"generate-calendar-invite\" class=\"calendar-details\"\u003e\u003ca href=\"#\"\u003e\u003cimg\r\n                            src=\"/Icon_Add_To_Calendar\"\u003e\u003cspan\u003eAdd to calendar\u003c/span\u003e\u003c/a\u003e\u003c/div\u003e\r\n                    \u003c/div\u003e\r\n                \u003c/div\u003e\r\n                \u003cdiv class=\"otherSection\"\u003e\r\n                    \u003clegend class=\"section-header-label\"\u003e\r\n                        Is there anything else you would like us to know?\u003c/legend\u003e\r\n                    \u003cdiv id=\"appointment-description\"\u003e${descriptionValue}\u003c/div\u003e\r\n                \u003c/div\u003e\r\n                \u003cdiv style=\"margin-top: 65px;\"\u003e\r\n                    \u003cinput type=\"button\" class=\"button1\" id=\"another-app\" value=\"Book another appointment\"\r\n                        style=\"width: 353px;\"\u003e\r\n                    \u003cinput type=\"button\" class=\"button1\" id=\"reschedule-app\" value=\"Reschedule\" \r\n                        style=\"width: 200px; float: right;\"\u003e\r\n                \u003c/div\u003e\r\n            \u003c/div\u003e\r\n        \u003c/fieldset\u003e\r\n    \u003c/td\u003e`;\r\n\r\n    $(\u0027table[data-name=\"main-section\"] tbody\u0027).find(\u0027tr\u0027).first().append(reviewDetails.text());\r\n\r\n    $(\"#another-app\").click(function() { window.location = window.location.pathname });  \r\n    $(\"#reschedule-app\").click(function() { window.location = window.location.origin + \"/reschedule-appointment/?id=\" + $(\"#EntityFormView_EntityID\").val() });\r\n\r\n    $(\"#generate-calendar-invite\").click(function() {\r\n        msgData1 = moment(new Date(scheduledstart + \" UTC\")).format(\u0027MMM DD, YYYY | hh:mm A\u0027);\r\n        msgData2 = moment(new Date(scheduledend + \" UTC\")).format(\u0027MMM DD, YYYY | hh:mm A\u0027);\r\n        msgData3 = address;\r\n        email = email;\r\n        const icsMSG = \"BEGIN:VCALENDAR\\nVERSION:2.0\\nPRODID:-//Our Company//NONSGML v1.0//EN\\nBEGIN:VEVENT\\nUID:me@google.com\\nDTSTAMP:yyyymmddThhmmssZ\\nATTENDEE;CN=Organizer;RSVP=TRUE:MAILTO:\u0027\" + email + \"\u0027\\nORGANIZER;CN=:MAILTO::\u0027\" + email + \"\u0027\\nDTSTART:\" + msgData1 + \"\\nDTEND:\" + msgData2 + \"\\nLOCATION:\" + msgData3 + \"\\nSUMMARY:Appointment\\nEND:VEVENT\\nEND:VCALENDAR\";\r\n        window.open(\"data:text/calendar;charset=utf8,\" + escape(icsMSG));\r\n    });\r\n})",
        "statuscode":  1,
        "mspp_attachfilerestrictaccept":  false,
        "mspp_validationsummarylinktext":  null,
        "_mspp_nextstep_value":  null,
        "mspp_associatecurrentportaluser":  false,
        "mspp_redirecturlquerystringattribute":  "msdyn_appointmentrequestid",
        "mspp_referenceentityprimarykeylogicalname":  null,
        "_mspp_entitysourcestep_value":  "32ec11b2-d4dc-f011-8406-002248e10de6",
        "mspp_referenceentityrelationshipname":  null,
        "mspp_targetentityportaluserlookupattribute":  null,
        "_mspp_previousstep_value":  null,
        "mspp_title":  null,
        "mspp_multiplerecordsperuserpermitted":  false,
        "mspp_referenceentitylogicalname":  null,
        "mspp_maximumnooffiles":  null,
        "mspp_geolocation_formattedaddressfieldname":  null,
        "mspp_successmessage":  null,
        "mspp_editexistingrecordpermitted":  false,
        "mspp_geolocation_postalcodefieldname":  null,
        "mspp_submitbuttonbusytext":  null,
        "mspp_referencequeryattributelogicalname":  null,
        "mspp_recordsourcerelationshipname":  null,
        "mspp_referencequerystringisprimarykey":  true,
        "mspp_geolocation_enabled":  false,
        "mspp_savedeventkeyname":  null,
        "mspp_attachfiletypeerrormessage":  null,
        "_mspp_webform_value":  "925a17a6-d4dc-f011-8406-002248e10de6",
        "mspp_movepreviouspermitted":  true,
        "mspp_tooltipenabled":  false,
        "mspp_redirecturl":  null,
        "_mspp_redirectwebpage_value":  "095b17a6-d4dc-f011-8406-002248e10de6",
        "mspp_previousbuttoncssclass":  null,
        "mspp_geolocation_maptype":  756150000,
        "mspp_createautonumber":  false,
        "mspp_attachfilesizeerrormessage":  null,
        "mspp_provisionedlanguages":  null,
        "mspp_geolocation_countyfieldname":  null,
        "mspp_userhostaddressattributelogicalname":  null,
        "mspp_instructions":  null,
        "mspp_submitbuttoncssclass":  null,
        "mspp_primarykeyquerystringparametername":  null,
        "mspp_validationsummarylinksenabled":  true,
        "_mspp_conditiondefaultnextstep_value":  null,
        "mspp_storageaccountname":  null,
        "mspp_geolocation_neighborhoodfieldname":  null,
        "mspp_type":  100000001,
        "mspp_entitysourcetype":  100000003,
        "mspp_validationsummarycssclass":  null,
        "mspp_modifiedon":  "2025-12-19T12:18:46Z",
        "mspp_referenceentityshowreadonlyform":  false,
        "mspp_attachfilemaxsize":  null,
        "mspp_mode":  100000002,
        "mspp_autonumberdefinitionname":  null,
        "mspp_geolocation_addresslinefieldname":  null,
        "mspp_validationgroup":  null,
        "mspp_geolocation_latitudefieldname":  null,
        "mspp_allowmultiplefiles":  false,
        "mspp_primarykeyattributelogicalname":  null,
        "mspp_postbackurl":  null,
        "_mspp_createdby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_portaluserlookupattributeisactivityparty":  false,
        "mspp_geolocation_statefieldname":  null,
        "mspp_redirecturlquerystringname":  null,
        "mspp_name":  "Appointment Confirmation",
        "mspp_populatereferenceentitylookupfield":  false
    },
    {
        "mspp_attachfilerequirederrormessage":  null,
        "mspp_tabname":  null,
        "mspp_appendquerystring":  false,
        "mspp_forceallfieldsrequired":  false,
        "mspp_referencetargetlookupattributelogicalname":  null,
        "mspp_targetentitylogicalname":  "msdyn_appointmentrequest",
        "mspp_loguser":  false,
        "mspp_referencesourceentitylogicalname":  null,
        "mspp_nextbuttontext":  null,
        "mspp_renderwebresourcesinline":  false,
        "mspp_useridentitynameattributelogicalname":  null,
        "mspp_webformstepid":  "32ec11b2-d4dc-f011-8406-002248e10de6",
        "_mspp_modifiedby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_autogeneratesteps":  false,
        "mspp_createdon":  "2025-12-19T12:17:39Z",
        "mspp_editexpiredstatecode":  null,
        "mspp_submiteventkeyname":  null,
        "mspp_redirecturlcustomquerystring":  null,
        "mspp_nextbuttoncssclass":  "btn button1",
        "mspp_accept":  null,
        "mspp_movepreviouseventkeyname":  null,
        "mspp_captcharequired":  false,
        "mspp_referenceentityreadonlyformname":  "",
        "mspp_formname":  "Create an appointment Step 1",
        "mspp_validationsummaryheadertext":  null,
        "mspp_referenceentitysourcetype":  100000001,
        "mspp_referencerecordsourcerelationshipname":  null,
        "mspp_savingeventkeyname":  null,
        "mspp_condition":  null,
        "_mspp_referenceentitystep_value":  null,
        "mspp_autonumberattributelogicalname":  null,
        "mspp_settings":  null,
        "mspp_usercontrolpath":  null,
        "mspp_previousbuttontext":  null,
        "mspp_editexpiredstatusreason":  null,
        "mspp_hideformonsuccess":  true,
        "mspp_showunsupportedfields":  false,
        "mspp_attachfilerequired":  false,
        "mspp_entitypermissionsenabled":  true,
        "mspp_showownerfields":  false,
        "mspp_attachfilelabel":  null,
        "mspp_usercontroltitle":  "",
        "mspp_targetentityprimarykeylogicalname":  null,
        "mspp_attachfilestoragelocation":  null,
        "mspp_submitbuttontext":  null,
        "mspp_recordnotfoundmessage":  null,
        "mspp_redirecturlappendentityidquerystring":  false,
        "mspp_containername":  null,
        "statecode":  0,
        "mspp_redirecturlquerystringattributeparamname":  null,
        "mspp_geolocation_longitudefieldname":  null,
        "mspp_attachfile":  false,
        "mspp_geolocation_displaymap":  false,
        "mspp_setentityreference":  false,
        "mspp_referencequerystringname":  null,
        "mspp_geolocation_cityfieldname":  null,
        "mspp_editnotpermittedmessage":  null,
        "mspp_editexpiredmessage":  null,
        "mspp_showcaptchaforauthenticatedusers":  false,
        "mspp_loadeventkeyname":  null,
        "mspp_recommendedfieldsrequired":  false,
        "mspp_geolocation_countryfieldname":  null,
        "mspp_registerstartupscript":  "$(function () {\r\n    $(\"[data-name=\u0027lookup-service-section\u0027]\").parent().hide();\r\n\r\n    (function (webapi, $) {\r\n        function safeAjax(ajaxOptions) {\r\n            var deferredAjax = $.Deferred();\r\n            shell.getTokenDeferred().done(function (token) {\r\n                // Add headers for ajax\r\n                if (!ajaxOptions.headers) {\r\n                    $.extend(ajaxOptions, {\r\n                        headers: {\r\n                            \"__RequestVerificationToken\": token\r\n                        }\r\n                    });\r\n                } else {\r\n                    ajaxOptions.headers[\"__RequestVerificationToken\"] = token;\r\n                }\r\n                $.ajax(ajaxOptions)\r\n                  .done(function (data, textStatus, jqXHR) {\r\n                      validateLoginSession(data, textStatus, jqXHR, deferredAjax.resolve);\r\n                  }).fail(deferredAjax.reject); //ajax\r\n            }).fail(function () {\r\n                deferredAjax.rejectWith(this, arguments); // On token failure pass the token ajax and args\r\n            });\r\n            return deferredAjax.promise();\r\n        }\r\n        webapi.safeAjax = safeAjax;\r\n    })(window.webapi = window.webapi || {}, jQuery)\r\n    // Notification component\r\n    var notificationMsg = (function () {\r\n        var $processingMsgEl = $(\"[data-name=\u0027processingMsg\u0027] \u003e tbody \u003e tr \u003e td\").eq(0),\r\n          _msg = \u0027Loading...\u0027,\r\n          _stack = 0,\r\n          _endTimeout;\r\n        return {\r\n            show: function (msg) {\r\n                $processingMsgEl.text(msg || _msg);\r\n                if (_stack === 0) {\r\n                    clearTimeout(_endTimeout);\r\n                    $processingMsgEl.show();\r\n                }\r\n                _stack++;\r\n            },\r\n            hide: function () {\r\n                _stack--;\r\n                if (_stack \u003c= 0) {\r\n                    _stack = 0;\r\n                    clearTimeout(_endTimeout);\r\n                    _endTimeout = setTimeout(function () {\r\n                        $processingMsgEl.hide();\r\n                    }, 500);\r\n                }\r\n            }\r\n        }\r\n    })();\r\n\r\n    function appAjax(processingMsg, ajaxOptions) {\r\n        notificationMsg.show(processingMsg);\r\n        return webapi.safeAjax(ajaxOptions)\r\n          .fail(function (response) {\r\n              if (response.responseJSON) {\r\n                  alert(\"Error: \" + response.responseJSON.error.message)\r\n              } else {\r\n                  alert(\"Error: Web API is not available... \")\r\n              }\r\n          }).always(notificationMsg.hide);\r\n    }\r\n\r\n    function loadRecords() {\r\n        return appAjax(\u0027Loading...\u0027, {\r\n            type: \"GET\",\r\n            url: \"/_api/msdyn_services\",\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    const categoriesSectionContainer = $(\"[data-name=\u0027categories_section\u0027]\").parent();\r\n    const subCategoriesSectionContainer = $(\"[data-name=\u0027sub_categories_section\u0027]\").parent();\r\n\r\n\r\n    const categoriesSection = $(\"[data-name=\u0027categories_section\u0027] \u003e tbody \u003e tr \u003e td\").eq(0).removeClass(\"zero-cell\").eq(0);\r\n    const subCategoriesSection = $(\"[data-name=\u0027sub_categories_section\u0027] \u003e tbody \u003e tr \u003e td\").eq(0)\r\n    const keyPrefix = \"@OData.Community.Display.V1.FormattedValue\";\r\n\r\n    loadRecords().done(function (data) {\r\n        initializeCards(data.value);\r\n    });\r\n\r\n    function initializeCards(data) {\r\n        let categoryMap = {};\r\n\r\n        categoryMap = data.reduce(function (r, a) {\r\n            const currentCategory = a[`msdyn_servicecategory${keyPrefix}`];\r\n\r\n            r[currentCategory] = r[currentCategory] || [];\r\n            r[currentCategory].push(a);\r\n            return r;\r\n        }, Object.create(null));\r\n\r\n        let categoriesSectionHtml = \"\u003cdiv class=\u0027category-cards-container\u0027 style=\u0027outline: none;\u0027\u003e\";\r\n\r\n        let first = true;\r\n        for (const category in categoryMap) {\r\n            const list = categoryMap[category].map((subcategory) =\u003e `\u003cli\u003e${subcategory[\"msdyn_name\"]}\u003c/li\u003e`)\r\n            const alphaNumericServiceName = category.replace(/[^a-zA-Z0-9]/g, \u0027\u0027).toLowerCase();\r\n\r\n            categoriesSectionHtml += `\r\n            \u003cinput type=\"radio\" id=\"${category}\" name=\"category\" value=\"${category}\" class=\"hide\"\u003e\r\n            \u003clabel for=\"${category}\"\u003e\r\n                \u003cdiv class=\"card\"\u003e\r\n                    \u003cdiv class=\"selected-bg\"\u003e\u003c/div\u003e\r\n                    \u003cdiv class=\"card-header text-center category-header ${alphaNumericServiceName}\"\u003e\r\n                        ${category}\r\n                    \u003c/div\u003e\r\n                    \u003cdiv class=\"card-body\"\u003e\r\n                        \u003cul class=\"p-0\"\u003e\r\n                            ${list.join(\"\")}      \r\n                        \u003c/ul\u003e\r\n                    \u003c/div\u003e\r\n                \u003c/div\u003e\r\n            \u003c/label\u003e`;\r\n\r\n            first = false;\r\n        }\r\n\r\n        categoriesSectionHtml += \u0027\u003c/div\u003e\u0027;\r\n        categoriesSection.html(categoriesSectionHtml);\r\n\r\n        let preventNextChange = false;\r\n\r\n        function submitSelectedCategory (fromKeyboardNav) {\r\n            let selectedCategory = $(this).filter(\u0027:checked\u0027).val();\r\n            categoriesSectionContainer.hide();\r\n            let subCategoriesSectionHtml = \"\u003cdiv class=\u0027category-cards-container\u0027\u003e\";\r\n\r\n            let first = true;\r\n            for (const subCategory of categoryMap[selectedCategory]) {\r\n                const subCategoryName = subCategory[\u0027msdynce_servicesubcategory\u0027+keyPrefix]\r\n                const alphaNumericServiceName = subCategoryName.replace(/[^a-zA-Z0-9]/g, \u0027\u0027).toLowerCase();\r\n\r\n                subCategoriesSectionHtml += `\r\n                \u003cinput type=\"radio\" id=\"${subCategory.msdyn_serviceid}\" class=\"hide\" value=\"${subCategory.msdyn_name}\" \r\n                        name=\"subCategory\" data-serviceCategory=\"${subCategoryName}\"/\u003e\r\n                \u003clabel for=\"${subCategory.msdyn_serviceid}\"\u003e\r\n                    \u003cdiv class=\"selected-bg\"\u003e\u003c/div\u003e\r\n                    \u003cdiv class=\"card\"\u003e\r\n                        \u003cdiv class=\" text-center sub-category-header\"\u003e\r\n                            \u003cimg src=\"/${alphaNumericServiceName}.png\" /\u003e\r\n                            ${subCategory.msdyn_name}\u003c/div\u003e\r\n                        \u003cdiv class=\"card-body\"\u003e\r\n                            ${subCategory.msdyn_servicedescription}\r\n                        \u003c/div\u003e\r\n                    \u003c/div\u003e\r\n                \u003c/label\u003e`;\r\n\r\n                first = false;\r\n            }\r\n\r\n            subCategoriesSectionHtml += \u0027\u003c/div\u003e\u0027;\r\n            subCategoriesSection.html(subCategoriesSectionHtml);\r\n\r\n            if (fromKeyboardNav) {\r\n                $(\u0027:radio[name=\"subCategory\"][tabindex=\"0\"]\u0027).focus();\r\n            }\r\n\r\n            function submitSelectedSubCategory () {\r\n                const selectedRadio = $(this).filter(\u0027:checked\u0027);\r\n\r\n                // reset the tab index to the selected radio otherwise the tab stop is skipped\r\n                $(\u0027:radio[name=\"subCategory\"]\u0027).attr(\"tabindex\", \"-1\");\r\n                selectedRadio.attr(\"tabindex\", \"0\");\r\n\r\n                $(\u0027:radio[name=\"subCategory\"]\u0027).each(function() {\r\n                    const specialityName = $(this).attr(\"data-serviceCategory\")\r\n                    const imageName = \"/\" + specialityName.replace(/[^a-zA-Z0-9]/g, \u0027\u0027).toLowerCase() + \".png\";\r\n                    const imageTag = $(this).next().find(\u0027img\u0027);\r\n                    imageTag.attr(\"src\", imageName);\r\n                });\r\n\r\n                const specialityName = $(this).attr(\"data-serviceCategory\")\r\n                const imageName = \"/\" + specialityName.replace(/[^a-zA-Z0-9]/g, \u0027\u0027).toLowerCase() + \"-selected.png\";\r\n                const imageTag = $(this).next().find(\u0027img\u0027);\r\n                imageTag.attr(\"src\", imageName);\r\n\r\n                $(\"#msdyn_services_name\").attr(\"value\", selectedRadio.val());\r\n                $(\"#msdyn_services\").attr(\"value\", selectedRadio.attr(\"id\"));\r\n                $(\"#msdyn_services_entityname\").attr(\"value\", \"msdyn_service\");\r\n            }\r\n\r\n            $(\u0027:radio[name=\"subCategory\"]\u0027).keydown(function (evt) {\r\n                if (evt.key === \" \" || evt.key === \"Enter\") {\r\n                    $(this).prop(\u0027checked\u0027, true);\r\n                    preventNextChange = false;\r\n                    submitSelectedSubCategory.call(this);\r\n                    $(\"input#NextButton.btn.button1\").click();\r\n                } else {\r\n                    preventNextChange = evt.key !== \"Tab\";\r\n                }\r\n            });\r\n\r\n            $(\u0027:radio[name=\"subCategory\"]\u0027).click(function (evt) {\r\n                if (preventNextChange) { // this gets called with keyboard arrow navigation\r\n                    evt.preventDefault();\r\n                    preventNextChange = false;\r\n                    return;\r\n                }\r\n                submitSelectedSubCategory.call(this);\r\n                $(\"input#NextButton.btn.button1\").click();\r\n            });\r\n        }\r\n\r\n        $(\u0027:radio[name=\"category\"]\u0027).keydown(function (evt) {\r\n            if (evt.key === \" \" || evt.key === \"Enter\") {\r\n                $(this).prop(\u0027checked\u0027, true);\r\n                preventNextChange = false;\r\n                submitSelectedCategory.call(this, true);\r\n            } else {\r\n                preventNextChange = evt.key !== \"Tab\";\r\n            }\r\n        });\r\n\r\n        $(\u0027:radio[name=\"category\"]\u0027).click(function (evt) {\r\n            if (preventNextChange) { // this gets called with keyboard arrow navigation\r\n                evt.preventDefault();\r\n                preventNextChange = false;\r\n                return;\r\n            }\r\n            submitSelectedCategory.call(this);\r\n        });\r\n\r\n        $(\".category-cards-container\").focus();\r\n    }\r\n});\r\n",
        "statuscode":  1,
        "mspp_attachfilerestrictaccept":  false,
        "mspp_validationsummarylinktext":  null,
        "_mspp_nextstep_value":  "23880ab8-d4dc-f011-8406-002248e10de6",
        "mspp_associatecurrentportaluser":  false,
        "mspp_redirecturlquerystringattribute":  null,
        "mspp_referenceentityprimarykeylogicalname":  null,
        "_mspp_entitysourcestep_value":  null,
        "mspp_referenceentityrelationshipname":  null,
        "mspp_targetentityportaluserlookupattribute":  null,
        "_mspp_previousstep_value":  null,
        "mspp_title":  "[{\"LCID\":1033,\"Value\":\"\u003ch3\u003e1. Servicios\u003c/h3\u003e\"}]",
        "mspp_multiplerecordsperuserpermitted":  false,
        "mspp_referenceentitylogicalname":  null,
        "mspp_maximumnooffiles":  null,
        "mspp_geolocation_formattedaddressfieldname":  null,
        "mspp_successmessage":  null,
        "mspp_editexistingrecordpermitted":  false,
        "mspp_geolocation_postalcodefieldname":  null,
        "mspp_submitbuttonbusytext":  null,
        "mspp_referencequeryattributelogicalname":  null,
        "mspp_recordsourcerelationshipname":  null,
        "mspp_referencequerystringisprimarykey":  true,
        "mspp_geolocation_enabled":  false,
        "mspp_savedeventkeyname":  null,
        "mspp_attachfiletypeerrormessage":  null,
        "_mspp_webform_value":  "925a17a6-d4dc-f011-8406-002248e10de6",
        "mspp_movepreviouspermitted":  true,
        "mspp_tooltipenabled":  false,
        "mspp_redirecturl":  null,
        "_mspp_redirectwebpage_value":  null,
        "mspp_previousbuttoncssclass":  "btn button2",
        "mspp_geolocation_maptype":  756150000,
        "mspp_createautonumber":  false,
        "mspp_attachfilesizeerrormessage":  null,
        "mspp_provisionedlanguages":  null,
        "mspp_geolocation_countyfieldname":  null,
        "mspp_userhostaddressattributelogicalname":  null,
        "mspp_instructions":  null,
        "mspp_submitbuttoncssclass":  null,
        "mspp_primarykeyquerystringparametername":  null,
        "mspp_validationsummarylinksenabled":  true,
        "_mspp_conditiondefaultnextstep_value":  null,
        "mspp_storageaccountname":  null,
        "mspp_geolocation_neighborhoodfieldname":  null,
        "mspp_type":  100000001,
        "mspp_entitysourcetype":  null,
        "mspp_validationsummarycssclass":  null,
        "mspp_modifiedon":  "2025-12-19T12:18:47Z",
        "mspp_referenceentityshowreadonlyform":  false,
        "mspp_attachfilemaxsize":  null,
        "mspp_mode":  100000000,
        "mspp_autonumberdefinitionname":  null,
        "mspp_geolocation_addresslinefieldname":  null,
        "mspp_validationgroup":  null,
        "mspp_geolocation_latitudefieldname":  null,
        "mspp_allowmultiplefiles":  false,
        "mspp_primarykeyattributelogicalname":  null,
        "mspp_postbackurl":  null,
        "_mspp_createdby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_portaluserlookupattributeisactivityparty":  false,
        "mspp_geolocation_statefieldname":  null,
        "mspp_redirecturlquerystringname":  null,
        "mspp_name":  "1. Services",
        "mspp_populatereferenceentitylookupfield":  false
    },
    {
        "mspp_attachfilerequirederrormessage":  null,
        "mspp_tabname":  "Reschedule",
        "mspp_appendquerystring":  false,
        "mspp_forceallfieldsrequired":  false,
        "mspp_referencetargetlookupattributelogicalname":  null,
        "mspp_targetentitylogicalname":  "appointment",
        "mspp_loguser":  false,
        "mspp_referencesourceentitylogicalname":  null,
        "mspp_nextbuttontext":  null,
        "mspp_renderwebresourcesinline":  false,
        "mspp_useridentitynameattributelogicalname":  null,
        "mspp_webformstepid":  "3aec11b2-d4dc-f011-8406-002248e10de6",
        "_mspp_modifiedby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_autogeneratesteps":  false,
        "mspp_createdon":  "2025-12-19T12:17:39Z",
        "mspp_editexpiredstatecode":  null,
        "mspp_submiteventkeyname":  null,
        "mspp_redirecturlcustomquerystring":  null,
        "mspp_nextbuttoncssclass":  null,
        "mspp_accept":  null,
        "mspp_movepreviouseventkeyname":  null,
        "mspp_captcharequired":  false,
        "mspp_referenceentityreadonlyformname":  "",
        "mspp_formname":  "Appointment",
        "mspp_validationsummaryheadertext":  null,
        "mspp_referenceentitysourcetype":  100000001,
        "mspp_referencerecordsourcerelationshipname":  null,
        "mspp_savingeventkeyname":  null,
        "mspp_condition":  null,
        "_mspp_referenceentitystep_value":  null,
        "mspp_autonumberattributelogicalname":  null,
        "mspp_settings":  null,
        "mspp_usercontrolpath":  null,
        "mspp_previousbuttontext":  null,
        "mspp_editexpiredstatusreason":  null,
        "mspp_hideformonsuccess":  true,
        "mspp_showunsupportedfields":  false,
        "mspp_attachfilerequired":  false,
        "mspp_entitypermissionsenabled":  true,
        "mspp_showownerfields":  false,
        "mspp_attachfilelabel":  null,
        "mspp_usercontroltitle":  "",
        "mspp_targetentityprimarykeylogicalname":  null,
        "mspp_attachfilestoragelocation":  null,
        "mspp_submitbuttontext":  null,
        "mspp_recordnotfoundmessage":  null,
        "mspp_redirecturlappendentityidquerystring":  false,
        "mspp_containername":  null,
        "statecode":  0,
        "mspp_redirecturlquerystringattributeparamname":  null,
        "mspp_geolocation_longitudefieldname":  null,
        "mspp_attachfile":  false,
        "mspp_geolocation_displaymap":  false,
        "mspp_setentityreference":  false,
        "mspp_referencequerystringname":  null,
        "mspp_geolocation_cityfieldname":  null,
        "mspp_editnotpermittedmessage":  null,
        "mspp_editexpiredmessage":  null,
        "mspp_showcaptchaforauthenticatedusers":  false,
        "mspp_loadeventkeyname":  null,
        "mspp_recommendedfieldsrequired":  false,
        "mspp_geolocation_countryfieldname":  null,
        "mspp_registerstartupscript":  "$(function() {\r\n    $(\"#EntityFormView\").hide();\r\n\r\n    const appointmentId = getUrlVars()[\"id\"];\r\n    var appointmentData;\r\n    \r\n    var appointmentType, timeSlot, descriptionElement;\r\n\r\n    (function (webapi, $) {\r\n        function safeAjax(ajaxOptions) {\r\n            var deferredAjax = $.Deferred();\r\n            shell.getTokenDeferred().done(function (token) {\r\n                // Add headers for ajax\r\n                if (!ajaxOptions.headers) {\r\n                    $.extend(ajaxOptions, {\r\n                        headers: {\r\n                            \"__RequestVerificationToken\": token\r\n                        }\r\n                    });\r\n                } else {\r\n                    ajaxOptions.headers[\"__RequestVerificationToken\"] = token;\r\n                }\r\n                $.ajax(ajaxOptions)\r\n                    .done(function (data, textStatus, jqXHR) {\r\n                        validateLoginSession(data, textStatus, jqXHR, deferredAjax.resolve);\r\n                    }).fail(deferredAjax.reject); //ajax\r\n            }).fail(function () {\r\n                deferredAjax.rejectWith(this, arguments); // On token failure pass the token ajax and args\r\n            });\r\n            return deferredAjax.promise();\r\n        }\r\n        webapi.safeAjax = safeAjax;\r\n    })(window.webapi = window.webapi || {}, jQuery)\r\n\r\n    function appAjax(processingMsg, ajaxOptions) {\r\n        return webapi.safeAjax(ajaxOptions)\r\n        .fail(function (response) {\r\n            if (response.responseJSON) {\r\n                alert(\"Error: \" + response.responseJSON.error.message)\r\n            } else {\r\n                alert(\"Error: Web API is not available... \")\r\n            }\r\n        });\r\n    }\r\n\r\n    fetchAppointment(appointmentId).done(function (data) {\r\n        appointmentData = data;\r\n        addDetails();\r\n        const serviceId = appointmentData._msdynce_services_value;\r\n        fetchService(serviceId);\r\n        $(\"#cust-name\").text(appointmentData.msdynce_firstname+\u0027 \u0027+appointmentData.msdynce_lastname);\r\n        $(\"#cust-email\").text(appointmentData.msdynce_emailaddress);\r\n        timeSlot = sessionStorage.getItem(\"selectedDateTime\");\r\n        $(\"#start-time\").text(sessionStorage.getItem(\"selectedDateTime\"));\r\n        if (appointmentData.msdyn_bankappointmenttype == 192350001) {\r\n            $(\"#meeting-type\").value(\"Virtual Meeting\");\r\n            $(\"#bank-name\").text(\"Conference Software\");\r\n        } else {\r\n            $(\"#meeting-type\").text(\"At the bank branch\");\r\n            $(\"#bank-name\").text(appointmentData[\"_msdyn_location_value@OData.Community.Display.V1.FormattedValue\"]);\r\n            var branchId = appointmentData[\"_msdyn_location_value\"];\r\n            fetchBranch(branchId);\r\n        }\r\n    });\r\n\r\n    function getUrlVars()\r\n    {\r\n        var vars = [], hash;\r\n        var hashes = window.location.href.slice(window.location.href.indexOf(\u0027?\u0027) + 1).split(\u0027\u0026\u0027);\r\n        for(var i = 0; i \u003c hashes.length; i++)\r\n        {\r\n            hash = hashes[i].split(\u0027=\u0027);\r\n            vars.push(hash[0]);\r\n            vars[hash[0]] = hash[1];\r\n        }\r\n        return vars;\r\n    }\r\n\r\n    function fetchService(serviceId) {\r\n        \r\n        return appAjax(\u0027Loading...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/msdyn_services(${serviceId})?$select=msdynce_servicesubcategory,msdyn_servicecategory`,\r\n            contentType: \"application/json\",\r\n            success: function(data) {\r\n                $(\"#service-category\").text(data[\u0027msdyn_servicecategory@OData.Community.Display.V1.FormattedValue\u0027]);\r\n                $(\"#service-sub-category\").text(data[\u0027msdynce_servicesubcategory@OData.Community.Display.V1.FormattedValue\u0027]);\r\n            }\r\n        });\r\n    }\r\n\r\n    function fetchBranch(branchId) {\r\n        return appAjax(\u0027Loading...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/msdyn_locations(${branchId})?$select=msdyn_name,msdyn_branchaddress`,\r\n            contentType: \"application/json\",\r\n            success: function (data) {\r\n                $(\"#bank-name\").text(data.msdyn_name);\r\n                $(\"#bank-address\").text(data.msdyn_branchaddress);\r\n            }\r\n        });\r\n    }\r\n\r\n    function fetchCustomerDetails(customerId) {\r\n        return appAjax(\u0027Fetching customer details...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/contacts(${customerId})?$select=fullname,mobilephone,emailaddress1`,\r\n            contentType: \"application/json\",\r\n            success:  function(data) {\r\n                $(\"#rep-name\").text(data.fullname);\r\n                $(\"#rep-phone\").text(data.mobilephone);\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    function fetchAppointment(appointmentId) {\r\n        return appAjax(\u0027Loading...\u0027, {\r\n            type: \"GET\",\r\n            url: `/_api/appointments(${appointmentId})`,\r\n            contentType: \"application/json\"\r\n        });\r\n    }\r\n\r\n    function rescheduleAppointment(appointmentId, attributeName, value) {\r\n        return appAjax(\u0027Updating...\u0027, {\r\n            type: \"PUT\",\r\n            url: `/_api/appointments(${appointmentId})/${attributeName}`,\r\n            data: JSON.stringify({\r\n            \"value\": value\r\n          })\r\n        });\r\n    }\r\n\r\n    $(\"#NextButton\").on(\u0027click\u0027, function() {\r\n        var d = sessionStorage.getItem(\"selectedDateTime\");\r\n        var dateVal = Date.parse(d);\r\n        var startDateUTC = moment(dateVal).utc();\r\n\r\n        appointmentData.scheduledStart = startDateUTC.format(\u0027YYYY-MM-DDTHH:mm:ss.0000000\\\\Z\u0027);\r\n        appointmentData.scheduledEnd = moment(startDateUTC).add(1, \u0027hours\u0027).format(\u0027YYYY-MM-DDTHH:mm:ss.0000000\\\\Z\u0027);\r\n        rescheduleAppointment(appointmentId, \"scheduledstart\", appointmentData.scheduledStart);\r\n        rescheduleAppointment(appointmentId, \"scheduledend\", appointmentData.scheduledEnd);\r\n    });\r\n\r\n    $(document).on(\u0027keyup\u0027, \u0027#description_text\u0027, function () {\r\n        $(\"#letterCountRow\").show();\r\n        const descriptionValue = $(this).val();\r\n        $(\"#letterCount\").text(descriptionValue.length);\r\n        descriptionElement.val(descriptionValue);\r\n    });\r\n\r\n    function addDetails(){\r\n    const reviewDetails = `\r\n    \u003ctd colspan=\"1\" id=\"reviewc1detailstable\" rowspan=\"1\" class=\"clearfix cell\"\u003e\r\n        \u003cdiv class=\"tab-title\"\u003e\r\n            Appointment details\r\n        \u003c/div\u003e\r\n        \u003cdiv class=\"review-card\"\u003e\u003cspan class=\"apt-title\"\u003eWhy?\u003c/span\u003e\r\n            \u003cdiv class=\"apt-details\"\u003e\r\n            \u003cul\u003e\r\n                \u003cli id=\"service-category\"\u003e\u003c/li\u003e\r\n                \u003cli id=\"service-sub-category\"\u003e\u003c/li\u003e\r\n            \u003c/ul\u003e\r\n            \u003c/div\u003e\r\n        \u003c/div\u003e\r\n        \u003cdiv class=\"review-card\"\u003e\u003cspan class=\"apt-title\"\u003eHow?\u003c/span\u003e\r\n            \u003cdiv class=\"apt-details\"\u003e\r\n            \u003cul\u003e\r\n                \u003cli id=\"meeting-type\"\u003e\u003c/li\u003e\r\n                \u003cli id=\"bank-name\"\u003e\u003c/li\u003e\r\n                \u003cli id=\"bank-address\"\u003e\u003c/li\u003e\r\n            \u003c/ul\u003e\r\n            \u003c/div\u003e\r\n        \u003c/div\u003e\r\n        \u003cdiv class=\"review-card\"\u003e\u003cspan class=\"apt-title\"\u003eYou are meeting with\u003c/span\u003e\r\n            \u003cdiv class=\"apt-details\"\u003e\r\n            \u003cul\u003e\r\n                \u003cli id=\"cust-name\"\u003e\u003c/li\u003e\r\n                \u003cli id=\"cust-email\"\u003e\u003c/li\u003e\r\n            \u003c/ul\u003e\r\n            \u003c/div\u003e\r\n            \u003cdiv class=\"edit-details\" style=\"display:none\"\u003eEdit\u003cimg src=\"/Icon_Edit_Pencil\"\u003e\u003c/div\u003e\r\n        \u003c/div\u003e\r\n        \u003cdiv class=\"review-card\"\u003e\u003cspan class=\"apt-title\"\u003eWhen?\u003c/span\u003e\r\n            \u003cdiv class=\"apt-details\"\u003e\r\n            \u003cul\u003e\r\n                \u003cli id=\"start-time\"\u003e\u003c/li\u003e\r\n                \u003cli\u003e(60 minutes)\u003c/li\u003e\r\n            \u003c/ul\u003e\r\n            \u003c/div\u003e\r\n            \u003cdiv class=\"edit-details\" style=\"display:none\"\u003eEdit\u003cimg src=\"/Icon_Edit_Pencil\"\u003e\u003c/div\u003e\r\n        \u003c/div\u003e\r\n        \u003cdiv class=\"custom-textarea clearfix\"\u003e\r\n            \u003cp\u003eIs there anything else you would like us to know?\u003c/p\u003e\r\n            \u003ctextarea maxlength=\"1000\" class=\"form-control customBox\" id=\"description_text\" style=\"resize: none;\"\r\n            placeholder=\"[This is a sample text] Let us know if there is something else you would like us to prepare for your appointment.\"\u003e\r\n            \u003c/textarea\u003e\r\n            \u003cspan id=\"letterCountRow\"\u003e\u003cspan id=\"letterCount\"\u003e\u003c/span\u003e/1,000\u003c/span\u003e\r\n        \u003c/div\u003e\r\n    \u003c/td\u003e`;\r\n\r\n    // $(\u0027[aria-label=\"Does everything look okay?\"]\u0027).find(\u0027tr\u0027).first().append(reviewDetails); // Leaving this line for reference\r\n    $(\u0027[data-name=\"main-section\"] tbody\u0027).find(\u0027tr\u0027).first().append(reviewDetails); // NOT TESTED - but two other selectors using the same aria label were fixed with this line\r\n    $(\u0027#WebFormPanel\u0027).prepend(reviewDetails);\r\n    }\r\n    // $(\u0027#description_text\u0027).val(appointmentData.description);\r\n});",
        "statuscode":  1,
        "mspp_attachfilerestrictaccept":  false,
        "mspp_validationsummarylinktext":  null,
        "_mspp_nextstep_value":  "1e880ab8-d4dc-f011-8406-002248e10de6",
        "mspp_associatecurrentportaluser":  false,
        "mspp_redirecturlquerystringattribute":  null,
        "mspp_referenceentityprimarykeylogicalname":  null,
        "_mspp_entitysourcestep_value":  "2d880ab8-d4dc-f011-8406-002248e10de6",
        "mspp_referenceentityrelationshipname":  null,
        "mspp_targetentityportaluserlookupattribute":  null,
        "_mspp_previousstep_value":  null,
        "mspp_title":  null,
        "mspp_multiplerecordsperuserpermitted":  false,
        "mspp_referenceentitylogicalname":  null,
        "mspp_maximumnooffiles":  null,
        "mspp_geolocation_formattedaddressfieldname":  null,
        "mspp_successmessage":  null,
        "mspp_editexistingrecordpermitted":  false,
        "mspp_geolocation_postalcodefieldname":  null,
        "mspp_submitbuttonbusytext":  null,
        "mspp_referencequeryattributelogicalname":  null,
        "mspp_recordsourcerelationshipname":  null,
        "mspp_referencequerystringisprimarykey":  true,
        "mspp_geolocation_enabled":  false,
        "mspp_savedeventkeyname":  null,
        "mspp_attachfiletypeerrormessage":  null,
        "_mspp_webform_value":  "620510ac-d4dc-f011-8406-002248e10de6",
        "mspp_movepreviouspermitted":  true,
        "mspp_tooltipenabled":  false,
        "mspp_redirecturl":  null,
        "_mspp_redirectwebpage_value":  null,
        "mspp_previousbuttoncssclass":  null,
        "mspp_geolocation_maptype":  756150000,
        "mspp_createautonumber":  false,
        "mspp_attachfilesizeerrormessage":  null,
        "mspp_provisionedlanguages":  null,
        "mspp_geolocation_countyfieldname":  null,
        "mspp_userhostaddressattributelogicalname":  null,
        "mspp_instructions":  null,
        "mspp_submitbuttoncssclass":  null,
        "mspp_primarykeyquerystringparametername":  null,
        "mspp_validationsummarylinksenabled":  true,
        "_mspp_conditiondefaultnextstep_value":  null,
        "mspp_storageaccountname":  null,
        "mspp_geolocation_neighborhoodfieldname":  null,
        "mspp_type":  100000001,
        "mspp_entitysourcetype":  100000003,
        "mspp_validationsummarycssclass":  null,
        "mspp_modifiedon":  "2025-12-19T12:18:49Z",
        "mspp_referenceentityshowreadonlyform":  false,
        "mspp_attachfilemaxsize":  null,
        "mspp_mode":  100000001,
        "mspp_autonumberdefinitionname":  null,
        "mspp_geolocation_addresslinefieldname":  null,
        "mspp_validationgroup":  null,
        "mspp_geolocation_latitudefieldname":  null,
        "mspp_allowmultiplefiles":  false,
        "mspp_primarykeyattributelogicalname":  null,
        "mspp_postbackurl":  null,
        "_mspp_createdby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_portaluserlookupattributeisactivityparty":  false,
        "mspp_geolocation_statefieldname":  null,
        "mspp_redirecturlquerystringname":  null,
        "mspp_name":  "Step 2 - Confirm Appointment Details",
        "mspp_populatereferenceentitylookupfield":  false
    },
    {
        "mspp_attachfilerequirederrormessage":  null,
        "mspp_tabname":  "tab_4",
        "mspp_appendquerystring":  false,
        "mspp_forceallfieldsrequired":  false,
        "mspp_referencetargetlookupattributelogicalname":  null,
        "mspp_targetentitylogicalname":  "appointment",
        "mspp_loguser":  false,
        "mspp_referencesourceentitylogicalname":  null,
        "mspp_nextbuttontext":  null,
        "mspp_renderwebresourcesinline":  false,
        "mspp_useridentitynameattributelogicalname":  null,
        "mspp_webformstepid":  "1e880ab8-d4dc-f011-8406-002248e10de6",
        "_mspp_modifiedby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_autogeneratesteps":  false,
        "mspp_createdon":  "2025-12-19T12:17:44Z",
        "mspp_editexpiredstatecode":  null,
        "mspp_submiteventkeyname":  null,
        "mspp_redirecturlcustomquerystring":  null,
        "mspp_nextbuttoncssclass":  null,
        "mspp_accept":  null,
        "mspp_movepreviouseventkeyname":  null,
        "mspp_captcharequired":  false,
        "mspp_referenceentityreadonlyformname":  "",
        "mspp_formname":  "Appointment",
        "mspp_validationsummaryheadertext":  null,
        "mspp_referenceentitysourcetype":  100000001,
        "mspp_referencerecordsourcerelationshipname":  null,
        "mspp_savingeventkeyname":  null,
        "mspp_condition":  null,
        "_mspp_referenceentitystep_value":  null,
        "mspp_autonumberattributelogicalname":  null,
        "mspp_settings":  null,
        "mspp_usercontrolpath":  null,
        "mspp_previousbuttontext":  null,
        "mspp_editexpiredstatusreason":  null,
        "mspp_hideformonsuccess":  true,
        "mspp_showunsupportedfields":  false,
        "mspp_attachfilerequired":  false,
        "mspp_entitypermissionsenabled":  true,
        "mspp_showownerfields":  false,
        "mspp_attachfilelabel":  null,
        "mspp_usercontroltitle":  "",
        "mspp_targetentityprimarykeylogicalname":  null,
        "mspp_attachfilestoragelocation":  null,
        "mspp_submitbuttontext":  null,
        "mspp_recordnotfoundmessage":  null,
        "mspp_redirecturlappendentityidquerystring":  false,
        "mspp_containername":  null,
        "statecode":  0,
        "mspp_redirecturlquerystringattributeparamname":  null,
        "mspp_geolocation_longitudefieldname":  null,
        "mspp_attachfile":  false,
        "mspp_geolocation_displaymap":  false,
        "mspp_setentityreference":  false,
        "mspp_referencequerystringname":  null,
        "mspp_geolocation_cityfieldname":  null,
        "mspp_editnotpermittedmessage":  null,
        "mspp_editexpiredmessage":  null,
        "mspp_showcaptchaforauthenticatedusers":  false,
        "mspp_loadeventkeyname":  null,
        "mspp_recommendedfieldsrequired":  false,
        "mspp_geolocation_countryfieldname":  null,
        "mspp_registerstartupscript":  null,
        "statuscode":  1,
        "mspp_attachfilerestrictaccept":  false,
        "mspp_validationsummarylinktext":  null,
        "_mspp_nextstep_value":  null,
        "mspp_associatecurrentportaluser":  false,
        "mspp_redirecturlquerystringattribute":  null,
        "mspp_referenceentityprimarykeylogicalname":  null,
        "_mspp_entitysourcestep_value":  "2d880ab8-d4dc-f011-8406-002248e10de6",
        "mspp_referenceentityrelationshipname":  null,
        "mspp_targetentityportaluserlookupattribute":  null,
        "_mspp_previousstep_value":  null,
        "mspp_title":  null,
        "mspp_multiplerecordsperuserpermitted":  false,
        "mspp_referenceentitylogicalname":  null,
        "mspp_maximumnooffiles":  null,
        "mspp_geolocation_formattedaddressfieldname":  null,
        "mspp_successmessage":  null,
        "mspp_editexistingrecordpermitted":  false,
        "mspp_geolocation_postalcodefieldname":  null,
        "mspp_submitbuttonbusytext":  null,
        "mspp_referencequeryattributelogicalname":  null,
        "mspp_recordsourcerelationshipname":  null,
        "mspp_referencequerystringisprimarykey":  true,
        "mspp_geolocation_enabled":  false,
        "mspp_savedeventkeyname":  null,
        "mspp_attachfiletypeerrormessage":  null,
        "_mspp_webform_value":  "620510ac-d4dc-f011-8406-002248e10de6",
        "mspp_movepreviouspermitted":  true,
        "mspp_tooltipenabled":  false,
        "mspp_redirecturl":  null,
        "_mspp_redirectwebpage_value":  "5aec11b2-d4dc-f011-8406-002248e10de6",
        "mspp_previousbuttoncssclass":  null,
        "mspp_geolocation_maptype":  756150000,
        "mspp_createautonumber":  false,
        "mspp_attachfilesizeerrormessage":  null,
        "mspp_provisionedlanguages":  null,
        "mspp_geolocation_countyfieldname":  null,
        "mspp_userhostaddressattributelogicalname":  null,
        "mspp_instructions":  null,
        "mspp_submitbuttoncssclass":  null,
        "mspp_primarykeyquerystringparametername":  null,
        "mspp_validationsummarylinksenabled":  true,
        "_mspp_conditiondefaultnextstep_value":  null,
        "mspp_storageaccountname":  null,
        "mspp_geolocation_neighborhoodfieldname":  null,
        "mspp_type":  100000003,
        "mspp_entitysourcetype":  100000003,
        "mspp_validationsummarycssclass":  null,
        "mspp_modifiedon":  "2025-12-19T12:18:46Z",
        "mspp_referenceentityshowreadonlyform":  false,
        "mspp_attachfilemaxsize":  null,
        "mspp_mode":  100000000,
        "mspp_autonumberdefinitionname":  null,
        "mspp_geolocation_addresslinefieldname":  null,
        "mspp_validationgroup":  null,
        "mspp_geolocation_latitudefieldname":  null,
        "mspp_allowmultiplefiles":  false,
        "mspp_primarykeyattributelogicalname":  null,
        "mspp_postbackurl":  null,
        "_mspp_createdby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_portaluserlookupattributeisactivityparty":  false,
        "mspp_geolocation_statefieldname":  null,
        "mspp_redirecturlquerystringname":  null,
        "mspp_name":  "Step 3- Confirm",
        "mspp_populatereferenceentitylookupfield":  false
    },
    {
        "mspp_attachfilerequirederrormessage":  null,
        "mspp_tabname":  null,
        "mspp_appendquerystring":  false,
        "mspp_forceallfieldsrequired":  false,
        "mspp_referencetargetlookupattributelogicalname":  null,
        "mspp_targetentitylogicalname":  "msdyn_appointmentrequest",
        "mspp_loguser":  false,
        "mspp_referencesourceentitylogicalname":  null,
        "mspp_nextbuttontext":  null,
        "mspp_renderwebresourcesinline":  false,
        "mspp_useridentitynameattributelogicalname":  null,
        "mspp_webformstepid":  "23880ab8-d4dc-f011-8406-002248e10de6",
        "_mspp_modifiedby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_autogeneratesteps":  false,
        "mspp_createdon":  "2025-12-19T12:17:44Z",
        "mspp_editexpiredstatecode":  null,
        "mspp_submiteventkeyname":  null,
        "mspp_redirecturlcustomquerystring":  null,
        "mspp_nextbuttoncssclass":  "btn button1",
        "mspp_accept":  null,
        "mspp_movepreviouseventkeyname":  null,
        "mspp_captcharequired":  false,
        "mspp_referenceentityreadonlyformname":  "",
        "mspp_formname":  "Create an appointment Step 2",
        "mspp_validationsummaryheadertext":  null,
        "mspp_referenceentitysourcetype":  100000001,
        "mspp_referencerecordsourcerelationshipname":  null,
        "mspp_savingeventkeyname":  null,
        "mspp_condition":  null,
        "_mspp_referenceentitystep_value":  "32ec11b2-d4dc-f011-8406-002248e10de6",
        "mspp_autonumberattributelogicalname":  null,
        "mspp_settings":  null,
        "mspp_usercontrolpath":  null,
        "mspp_previousbuttontext":  null,
        "mspp_editexpiredstatusreason":  null,
        "mspp_hideformonsuccess":  true,
        "mspp_showunsupportedfields":  false,
        "mspp_attachfilerequired":  false,
        "mspp_entitypermissionsenabled":  true,
        "mspp_showownerfields":  false,
        "mspp_attachfilelabel":  null,
        "mspp_usercontroltitle":  "",
        "mspp_targetentityprimarykeylogicalname":  null,
        "mspp_attachfilestoragelocation":  null,
        "mspp_submitbuttontext":  null,
        "mspp_recordnotfoundmessage":  null,
        "mspp_redirecturlappendentityidquerystring":  false,
        "mspp_containername":  null,
        "statecode":  0,
        "mspp_redirecturlquerystringattributeparamname":  null,
        "mspp_geolocation_longitudefieldname":  null,
        "mspp_attachfile":  false,
        "mspp_geolocation_displaymap":  false,
        "mspp_setentityreference":  false,
        "mspp_referencequerystringname":  null,
        "mspp_geolocation_cityfieldname":  null,
        "mspp_editnotpermittedmessage":  null,
        "mspp_editexpiredmessage":  null,
        "mspp_showcaptchaforauthenticatedusers":  false,
        "mspp_loadeventkeyname":  null,
        "mspp_recommendedfieldsrequired":  true,
        "mspp_geolocation_countryfieldname":  null,
        "mspp_registerstartupscript":  "$(function() {\r\n    $(\u0027[data-name=\"location-lookup\"]\u0027).parent().hide();\r\n    $(\u0027[data-name=\"zipcode-section\"]\u0027).parent().hide();\r\n    $(\"#msdyn_bankappointmenttype input[value=\u0027639040001\u0027]\").next().hide();\r\n    $(\"#msdyn_bankappointmenttype input[value=\u0027639040001\u0027]\").hide();\r\n\r\n    $(\u0027#msdyn_bankappointmenttype input[type=\"radio\"]\u0027).change(function() {\r\n        $(\u0027[data-name=\"zipcode-section\"]\u0027).parent().show();\r\n    });\r\n\r\n    if ($(\u0027#msdyn_bankappointmenttype input[type=\"radio\"]:checked\u0027).length \u003e 0) { // coming back from the next step\r\n        $(\u0027[data-name=\"zipcode-section\"]\u0027).parent().show();\r\n    }\r\n\r\n    if (typeof (Page_Validators) != \u0027undefined\u0027) {\r\n        // Create new validator\r\n        var newValidator = document.createElement(\u0027span\u0027);\r\n        newValidator.style.display = \"none\";\r\n        newValidator.id = \"branchValidator\";\r\n        newValidator.controltovalidate = \"msdyn_location\";\r\n        newValidator.errormessage = \"\u003ca href=\u0027#msdynce_zipcode_Container\u0027\u003ePlease select a branch.\u003c/a\u003e\";\r\n        newValidator.validationGroup = \"\";\r\n        newValidator.initialvalue = \"\";\r\n        newValidator.evaluationfunction = function () {\r\n            var value = $(\"#msdyn_location\").val();\r\n            if (value == null || value == \"\") {\r\n                return false;\r\n            } else {\r\n                return true;\r\n            }\r\n        };\r\n        Page_Validators.push(newValidator);\r\n    }\r\n\r\n    function selectLocation(rootEl) {\r\n        const location = $(rootEl).find(\".locationNameFieldContent\").text();\r\n        const locationGuid = $(rootEl).find(\".locationguid\").text();\r\n\r\n        $(\"#msdyn_location_name\").val(location || \"\");\r\n        $(\"#msdyn_location\").val(locationGuid || \"\");\r\n        $(\"#msdyn_location_entityname\").val(locationGuid ? \"msdyn_location\" : \"\");\r\n    }\r\n\r\n    function updateSelectedLocation() {\r\n        selectLocation($(\".ms-SelectionZone .is-selected\"));\r\n    }\r\n\r\n    function tryGoToNextStep() {\r\n        $(\"#NextButton\").trigger(\"click\");\r\n    }\r\n    \r\n    $(\u0027body\u0027)\r\n      .on(\u0027blur\u0027, \u0027.ms-DetailsRow\u0027, function() {\r\n          // Keyboard navigating via arrow keys and/or pressing space will change the selection.\r\n          // If the Next button is clicked/keyboard navigated to, we need to update the selection before submission.\r\n          updateSelectedLocation();\r\n      })\r\n      .on(\u0027click\u0027, \u0027.ms-List-cell\u0027, function() {\r\n          selectLocation(this);\r\n          tryGoToNextStep();\r\n      })\r\n      .on(\u0027keydown\u0027, \u0027.ms-List-cell\u0027, function (evt) {\r\n        if (evt.key === \"Enter\") {\r\n            selectLocation(this);\r\n            tryGoToNextStep();\r\n        }\r\n    });\r\n});\r\n",
        "statuscode":  1,
        "mspp_attachfilerestrictaccept":  false,
        "mspp_validationsummarylinktext":  null,
        "_mspp_nextstep_value":  "8f5a17a6-d4dc-f011-8406-002248e10de6",
        "mspp_associatecurrentportaluser":  false,
        "mspp_redirecturlquerystringattribute":  null,
        "mspp_referenceentityprimarykeylogicalname":  null,
        "_mspp_entitysourcestep_value":  "32ec11b2-d4dc-f011-8406-002248e10de6",
        "mspp_referenceentityrelationshipname":  null,
        "mspp_targetentityportaluserlookupattribute":  null,
        "_mspp_previousstep_value":  "32ec11b2-d4dc-f011-8406-002248e10de6",
        "mspp_title":  "[{\"LCID\":1033,\"Value\":\"\u003ch3\u003e2. Ubicación\u003c/h3\u003e\"}]",
        "mspp_multiplerecordsperuserpermitted":  false,
        "mspp_referenceentitylogicalname":  null,
        "mspp_maximumnooffiles":  null,
        "mspp_geolocation_formattedaddressfieldname":  null,
        "mspp_successmessage":  null,
        "mspp_editexistingrecordpermitted":  false,
        "mspp_geolocation_postalcodefieldname":  null,
        "mspp_submitbuttonbusytext":  null,
        "mspp_referencequeryattributelogicalname":  null,
        "mspp_recordsourcerelationshipname":  null,
        "mspp_referencequerystringisprimarykey":  true,
        "mspp_geolocation_enabled":  false,
        "mspp_savedeventkeyname":  null,
        "mspp_attachfiletypeerrormessage":  null,
        "_mspp_webform_value":  "925a17a6-d4dc-f011-8406-002248e10de6",
        "mspp_movepreviouspermitted":  true,
        "mspp_tooltipenabled":  false,
        "mspp_redirecturl":  null,
        "_mspp_redirectwebpage_value":  null,
        "mspp_previousbuttoncssclass":  "btn button2",
        "mspp_geolocation_maptype":  756150000,
        "mspp_createautonumber":  false,
        "mspp_attachfilesizeerrormessage":  null,
        "mspp_provisionedlanguages":  null,
        "mspp_geolocation_countyfieldname":  null,
        "mspp_userhostaddressattributelogicalname":  null,
        "mspp_instructions":  null,
        "mspp_submitbuttoncssclass":  null,
        "mspp_primarykeyquerystringparametername":  null,
        "mspp_validationsummarylinksenabled":  true,
        "_mspp_conditiondefaultnextstep_value":  "32ec11b2-d4dc-f011-8406-002248e10de6",
        "mspp_storageaccountname":  null,
        "mspp_geolocation_neighborhoodfieldname":  null,
        "mspp_type":  100000001,
        "mspp_entitysourcetype":  100000003,
        "mspp_validationsummarycssclass":  null,
        "mspp_modifiedon":  "2025-12-19T12:18:52Z",
        "mspp_referenceentityshowreadonlyform":  false,
        "mspp_attachfilemaxsize":  null,
        "mspp_mode":  100000001,
        "mspp_autonumberdefinitionname":  null,
        "mspp_geolocation_addresslinefieldname":  null,
        "mspp_validationgroup":  null,
        "mspp_geolocation_latitudefieldname":  null,
        "mspp_allowmultiplefiles":  false,
        "mspp_primarykeyattributelogicalname":  null,
        "mspp_postbackurl":  null,
        "_mspp_createdby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_portaluserlookupattributeisactivityparty":  false,
        "mspp_geolocation_statefieldname":  null,
        "mspp_redirecturlquerystringname":  null,
        "mspp_name":  "2. Location",
        "mspp_populatereferenceentitylookupfield":  false
    },
    {
        "mspp_attachfilerequirederrormessage":  null,
        "mspp_tabname":  "tab_3",
        "mspp_appendquerystring":  false,
        "mspp_forceallfieldsrequired":  false,
        "mspp_referencetargetlookupattributelogicalname":  null,
        "mspp_targetentitylogicalname":  "appointment",
        "mspp_loguser":  false,
        "mspp_referencesourceentitylogicalname":  null,
        "mspp_nextbuttontext":  null,
        "mspp_renderwebresourcesinline":  false,
        "mspp_useridentitynameattributelogicalname":  null,
        "mspp_webformstepid":  "2d880ab8-d4dc-f011-8406-002248e10de6",
        "_mspp_modifiedby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_autogeneratesteps":  false,
        "mspp_createdon":  "2025-12-19T12:17:45Z",
        "mspp_editexpiredstatecode":  null,
        "mspp_submiteventkeyname":  null,
        "mspp_redirecturlcustomquerystring":  null,
        "mspp_nextbuttoncssclass":  null,
        "mspp_accept":  null,
        "mspp_movepreviouseventkeyname":  null,
        "mspp_captcharequired":  false,
        "mspp_referenceentityreadonlyformname":  "",
        "mspp_formname":  "Appointment",
        "mspp_validationsummaryheadertext":  null,
        "mspp_referenceentitysourcetype":  100000001,
        "mspp_referencerecordsourcerelationshipname":  null,
        "mspp_savingeventkeyname":  null,
        "mspp_condition":  null,
        "_mspp_referenceentitystep_value":  null,
        "mspp_autonumberattributelogicalname":  null,
        "mspp_settings":  null,
        "mspp_usercontrolpath":  null,
        "mspp_previousbuttontext":  null,
        "mspp_editexpiredstatusreason":  null,
        "mspp_hideformonsuccess":  false,
        "mspp_showunsupportedfields":  false,
        "mspp_attachfilerequired":  false,
        "mspp_entitypermissionsenabled":  true,
        "mspp_showownerfields":  false,
        "mspp_attachfilelabel":  null,
        "mspp_usercontroltitle":  "",
        "mspp_targetentityprimarykeylogicalname":  null,
        "mspp_attachfilestoragelocation":  null,
        "mspp_submitbuttontext":  null,
        "mspp_recordnotfoundmessage":  null,
        "mspp_redirecturlappendentityidquerystring":  false,
        "mspp_containername":  null,
        "statecode":  0,
        "mspp_redirecturlquerystringattributeparamname":  null,
        "mspp_geolocation_longitudefieldname":  null,
        "mspp_attachfile":  false,
        "mspp_geolocation_displaymap":  false,
        "mspp_setentityreference":  false,
        "mspp_referencequerystringname":  null,
        "mspp_geolocation_cityfieldname":  null,
        "mspp_editnotpermittedmessage":  null,
        "mspp_editexpiredmessage":  null,
        "mspp_showcaptchaforauthenticatedusers":  false,
        "mspp_loadeventkeyname":  null,
        "mspp_recommendedfieldsrequired":  false,
        "mspp_geolocation_countryfieldname":  null,
        "mspp_registerstartupscript":  "\r\nvar appointmentId = getUrlVars()[\"id\"];\r\nvar appointmentData = getAppointment(appointmentId);\r\n\r\nfunction getAppointment() {\r\n        $.ajax({\r\n            //url: \u0027/getAllAppointments\u0027,\r\n            //dataType: \u0027json\u0027,\r\n            url: \u0027/_api/appointments(\u0027 + appointmentId + \u0027)\u0027,\r\n            type: \"GET\",\r\n            contentType: \u0027application/json\u0027,\r\n            success: function (response) {                \r\n                rData = response; \r\n                // getUnavailableAppointments();   \r\n                sessionStorage.setItem(\"BankRep\", response._msdynce_contact_value);\r\n\r\n                calendarLoad(checkIfIframeLoaded);             \r\n                return response;                    \r\n            },\r\n            error: function (e) {\r\n                alert(e.statusText);\r\n            }\r\n        });\r\n    }\r\n\r\nfunction getUrlVars()\r\n    {\r\n        var vars = [], hash;\r\n        var hashes = window.location.href.slice(window.location.href.indexOf(\u0027?\u0027) + 1).split(\u0027\u0026\u0027);\r\n        for(var i = 0; i \u003c hashes.length; i++)\r\n        {\r\n            hash = hashes[i].split(\u0027=\u0027);\r\n            vars.push(hash[0]);\r\n            vars[hash[0]] = hash[1];\r\n        }\r\n        return vars;\r\n    }\r\n\r\nfunction calendarLoad(callback){\r\n    var iframe = $(\u0027#WebResource_Calendar\u0027);    \r\n    iframe.on(\u0027load\u0027, function() {        \r\n        callback(this);\r\n    });\r\n}\r\n\r\nfunction checkIfIframeLoaded(iframe) {\r\n    console.log(\u0027checkIfIframeLoaded\u0027);\r\n    var iframeDoc = iframe.contentDocument || iframe.contentWindow.document;\r\n    var radioSlotObj = $(\"input[name=\u0027time\u0027]\", iframeDoc);\r\n\r\n    if(radioSlotObj != undefined){\r\n        radioSlotObj.click(function() {\r\n            var dateValueNext, timeValueNext;\r\n            var radioDateVal = $(\"input[name=\u0027weekview\u0027]:checked\", iframeDoc);\r\n            if(radioDateVal != undefined){\r\n                dateValueNext = radioDateVal.next(\"div.day-date\").find(\".slotDate\").text();\r\n                var radioSlotVal = $(\"input[name=\u0027time\u0027]:checked\", iframeDoc);\r\n                if(radioSlotVal != undefined){\r\n                    timeValueNext = radioSlotVal.next(\"div.time\").find(\"em\").text();\r\n                    var startDate = moment(dateValueNext + \" \" + timeValueNext).format(\u0027MM/DD/YYYY h:mm a\u0027);\r\n                    var endDate = moment(startDate).add(1, \u0027hours\u0027).format(\u0027MM/DD/YYYY h:mm a\u0027);\r\n                    setDateControlFieldValue(\"msdynce_scheduledstart\",startDate);\r\n                    setDateControlFieldValue(\"msdynce_scheduledend\", endDate); \r\n                    sessionStorage.setItem(\"selectedDateTime\",  moment(dateValueNext + \" \" + timeValueNext).format(\u0027MMM DD hh:mm a\u0027));\r\n                    $(\"#msdynce_selectedtimeslot\").val( moment(dateValueNext + \" \" + timeValueNext).format(\u0027MMM DD, YYYY | hh:mm A\u0027));\r\n                }\r\n            }\r\n        });  \r\n    }\r\n}\r\n\r\nfunction setDateControlFieldValue(fieldname,d){\r\n   //debugger;\r\n   var datefield = $(\u0027#\u0027+ fieldname);\r\n   var inputControl = $(\u0027#\u0027+ fieldname +\u0027_datepicker_description\u0027);\r\n   var dateFormat = inputControl.attr(\u0027data-date-format\u0027);\r\n   var dateVal = Date.parse(d);\r\n   var dateUTC = moment(dateVal).utc();\r\n\r\n   datefield.val(dateUTC.format(\u0027YYYY-MM-DDTHH:mm:ss.0000000\\\\Z\u0027));   \r\n   inputControl.val(dateUTC.format(dateFormat));\r\n}\r\n\r\nfunction setEmailRange(){}",
        "statuscode":  1,
        "mspp_attachfilerestrictaccept":  false,
        "mspp_validationsummarylinktext":  null,
        "_mspp_nextstep_value":  "3aec11b2-d4dc-f011-8406-002248e10de6",
        "mspp_associatecurrentportaluser":  true,
        "mspp_redirecturlquerystringattribute":  null,
        "mspp_referenceentityprimarykeylogicalname":  null,
        "_mspp_entitysourcestep_value":  null,
        "mspp_referenceentityrelationshipname":  null,
        "mspp_targetentityportaluserlookupattribute":  "msdynce_contact",
        "_mspp_previousstep_value":  null,
        "mspp_title":  null,
        "mspp_multiplerecordsperuserpermitted":  false,
        "mspp_referenceentitylogicalname":  null,
        "mspp_maximumnooffiles":  null,
        "mspp_geolocation_formattedaddressfieldname":  null,
        "mspp_successmessage":  null,
        "mspp_editexistingrecordpermitted":  false,
        "mspp_geolocation_postalcodefieldname":  null,
        "mspp_submitbuttonbusytext":  null,
        "mspp_referencequeryattributelogicalname":  null,
        "mspp_recordsourcerelationshipname":  null,
        "mspp_referencequerystringisprimarykey":  true,
        "mspp_geolocation_enabled":  false,
        "mspp_savedeventkeyname":  null,
        "mspp_attachfiletypeerrormessage":  null,
        "_mspp_webform_value":  "620510ac-d4dc-f011-8406-002248e10de6",
        "mspp_movepreviouspermitted":  true,
        "mspp_tooltipenabled":  false,
        "mspp_redirecturl":  null,
        "_mspp_redirectwebpage_value":  null,
        "mspp_previousbuttoncssclass":  null,
        "mspp_geolocation_maptype":  756150000,
        "mspp_createautonumber":  false,
        "mspp_attachfilesizeerrormessage":  null,
        "mspp_provisionedlanguages":  null,
        "mspp_geolocation_countyfieldname":  null,
        "mspp_userhostaddressattributelogicalname":  null,
        "mspp_instructions":  null,
        "mspp_submitbuttoncssclass":  null,
        "mspp_primarykeyquerystringparametername":  "id",
        "mspp_validationsummarylinksenabled":  true,
        "_mspp_conditiondefaultnextstep_value":  null,
        "mspp_storageaccountname":  null,
        "mspp_geolocation_neighborhoodfieldname":  null,
        "mspp_type":  100000002,
        "mspp_entitysourcetype":  100000001,
        "mspp_validationsummarycssclass":  null,
        "mspp_modifiedon":  "2025-12-19T12:18:50Z",
        "mspp_referenceentityshowreadonlyform":  false,
        "mspp_attachfilemaxsize":  null,
        "mspp_mode":  100000001,
        "mspp_autonumberdefinitionname":  null,
        "mspp_geolocation_addresslinefieldname":  null,
        "mspp_validationgroup":  null,
        "mspp_geolocation_latitudefieldname":  null,
        "mspp_allowmultiplefiles":  false,
        "mspp_primarykeyattributelogicalname":  "activityid",
        "mspp_postbackurl":  null,
        "_mspp_createdby_value":  "d431eaf0-ead8-f011-8543-002248384659",
        "mspp_portaluserlookupattributeisactivityparty":  false,
        "mspp_geolocation_statefieldname":  null,
        "mspp_redirecturlquerystringname":  null,
        "mspp_name":  "Step 1 - Time slot selection",
        "mspp_populatereferenceentitylookupfield":  false
    }
]
